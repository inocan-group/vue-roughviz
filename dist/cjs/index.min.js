"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("vue"),s=require("d3");function e(t,s,e){if(t&&t.length){const[i,a]=s,h=Math.PI/180*e,l=Math.cos(h),o=Math.sin(h);t.forEach((t=>{const[s,e]=t;t[0]=(s-i)*l-(e-a)*o+i,t[1]=(s-i)*o+(e-a)*l+a}))}}function i(t){const s=t[0],e=t[1];return Math.sqrt(Math.pow(s[0]-e[0],2)+Math.pow(s[1]-e[1],2))}function a(t,s,e,i){const a=s[1]-t[1],h=t[0]-s[0],l=a*t[0]+h*t[1],o=i[1]-e[1],r=e[0]-i[0],n=o*e[0]+r*e[1],c=a*r-o*h;return c?[(r*l-h*n)/c,(a*n-o*l)/c]:null}function h(t,s,e){const i=t.length;if(i<3)return!1;const a=[Number.MAX_SAFE_INTEGER,e],h=[s,e];let n=0;for(let s=0;s<i;s++){const e=t[s],c=t[(s+1)%i];if(r(e,c,h,a)){if(0===o(e,h,c))return l(e,h,c);n++}}return n%2==1}function l(t,s,e){return s[0]<=Math.max(t[0],e[0])&&s[0]>=Math.min(t[0],e[0])&&s[1]<=Math.max(t[1],e[1])&&s[1]>=Math.min(t[1],e[1])}function o(t,s,e){const i=(s[1]-t[1])*(e[0]-s[0])-(s[0]-t[0])*(e[1]-s[1]);return 0===i?0:i>0?1:2}function r(t,s,e,i){const a=o(t,s,e),h=o(t,s,i),r=o(e,i,t),n=o(e,i,s);return a!==h&&r!==n||!(0!==a||!l(t,e,s))||!(0!==h||!l(t,i,s))||!(0!==r||!l(e,t,i))||!(0!==n||!l(e,s,i))}function n(t,s){const i=[0,0],a=Math.round(s.hachureAngle+90);a&&e(t,i,a);const h=function(t,s){const e=[...t];e[0].join(",")!==e[e.length-1].join(",")&&e.push([e[0][0],e[0][1]]);const i=[];if(e&&e.length>2){let t=s.hachureGap;t<0&&(t=4*s.strokeWidth),t=Math.max(t,.1);const a=[];for(let t=0;t<e.length-1;t++){const s=e[t],i=e[t+1];if(s[1]!==i[1]){const t=Math.min(s[1],i[1]);a.push({ymin:t,ymax:Math.max(s[1],i[1]),x:t===s[1]?s[0]:i[0],islope:(i[0]-s[0])/(i[1]-s[1])})}}if(a.sort(((t,s)=>t.ymin<s.ymin?-1:t.ymin>s.ymin?1:t.x<s.x?-1:t.x>s.x?1:t.ymax===s.ymax?0:(t.ymax-s.ymax)/Math.abs(t.ymax-s.ymax))),!a.length)return i;let h=[],l=a[0].ymin;for(;h.length||a.length;){if(a.length){let t=-1;for(let s=0;s<a.length&&!(a[s].ymin>l);s++)t=s;a.splice(0,t+1).forEach((t=>{h.push({s:l,edge:t})}))}if(h=h.filter((t=>!(t.edge.ymax<=l))),h.sort(((t,s)=>t.edge.x===s.edge.x?0:(t.edge.x-s.edge.x)/Math.abs(t.edge.x-s.edge.x))),h.length>1)for(let t=0;t<h.length;t+=2){const s=t+1;if(s>=h.length)break;const e=h[t].edge,a=h[s].edge;i.push([[Math.round(e.x),l],[Math.round(a.x),l]])}l+=t,h.forEach((s=>{s.edge.x=s.edge.x+t*s.edge.islope}))}}return i}(t,s);return a&&(e(t,i,-a),function(t,s,i){const a=[];t.forEach((t=>a.push(...t))),e(a,s,i)}(h,i,-a)),h}class c{constructor(t){this.helper=t}fillPolygon(t,s){return this._fillPolygon(t,s)}_fillPolygon(t,s,e=!1){let i=n(t,s);if(e){const s=this.connectingLines(t,i);i=i.concat(s)}return{type:"fillSketch",ops:this.renderLines(i,s)}}renderLines(t,s){const e=[];for(const i of t)e.push(...this.helper.doubleLineOps(i[0][0],i[0][1],i[1][0],i[1][1],s));return e}connectingLines(t,s){const e=[];if(s.length>1)for(let a=1;a<s.length;a++){const h=s[a-1];if(i(h)<3)continue;const l=[s[a][0],h[1]];if(i(l)>3){const s=this.splitOnIntersections(t,l);e.push(...s)}}return e}midPointInPolygon(t,s){return h(t,(s[0][0]+s[1][0])/2,(s[0][1]+s[1][1])/2)}splitOnIntersections(t,s){const e=Math.max(5,.1*i(s)),l=[];for(let h=0;h<t.length;h++){const o=t[h],n=t[(h+1)%t.length];if(r(o,n,...s)){const t=a(o,n,s[0],s[1]);if(t){const a=i([t,s[0]]),h=i([t,s[1]]);a>e&&h>e&&l.push({point:t,distance:a})}}}if(l.length>1){const e=l.sort(((t,s)=>t.distance-s.distance)).map((t=>t.point));if(h(t,...s[0])||e.shift(),h(t,...s[1])||e.pop(),e.length<=1)return this.midPointInPolygon(t,s)?[s]:[];const i=[s[0],...e,s[1]],a=[];for(let s=0;s<i.length-1;s+=2){const e=[i[s],i[s+1]];this.midPointInPolygon(t,e)&&a.push(e)}return a}return this.midPointInPolygon(t,s)?[s]:[]}}class d extends c{fillPolygon(t,s){return this._fillPolygon(t,s,!0)}}class u extends c{fillPolygon(t,s){const e=this._fillPolygon(t,s),i=Object.assign({},s,{hachureAngle:s.hachureAngle+90}),a=this._fillPolygon(t,i);return e.ops=e.ops.concat(a.ops),e}}class g{constructor(t){this.helper=t}fillPolygon(t,s){const e=n(t,s=Object.assign({},s,{curveStepCount:4,hachureAngle:0,roughness:1}));return this.dotsOnLines(e,s)}dotsOnLines(t,s){const e=[];let a=s.hachureGap;a<0&&(a=4*s.strokeWidth),a=Math.max(a,.1);let h=s.fillWeight;h<0&&(h=s.strokeWidth/2);const l=a/4;for(const o of t){const t=i(o),r=t/a,n=Math.ceil(r)-1,c=t-n*a,d=(o[0][0]+o[1][0])/2-a/4,u=Math.min(o[0][1],o[1][1]);for(let t=0;t<n;t++){const i=u+c+t*a,o=this.helper.randOffsetWithRange(d-l,d+l,s),r=this.helper.randOffsetWithRange(i-l,i+l,s),n=this.helper.ellipse(o,r,h,h,s);e.push(...n.ops)}}return{type:"fillSketch",ops:e}}}class p{constructor(t){this.helper=t}fillPolygon(t,s){const e=n(t,s);return{type:"fillSketch",ops:this.dashedLine(e,s)}}dashedLine(t,s){const e=s.dashOffset<0?s.hachureGap<0?4*s.strokeWidth:s.hachureGap:s.dashOffset,a=s.dashGap<0?s.hachureGap<0?4*s.strokeWidth:s.hachureGap:s.dashGap,h=[];return t.forEach((t=>{const l=i(t),o=Math.floor(l/(e+a)),r=(l+a-o*(e+a))/2;let n=t[0],c=t[1];n[0]>c[0]&&(n=t[1],c=t[0]);const d=Math.atan((c[1]-n[1])/(c[0]-n[0]));for(let t=0;t<o;t++){const i=t*(e+a),l=i+e,o=[n[0]+i*Math.cos(d)+r*Math.cos(d),n[1]+i*Math.sin(d)+r*Math.sin(d)],c=[n[0]+l*Math.cos(d)+r*Math.cos(d),n[1]+l*Math.sin(d)+r*Math.sin(d)];h.push(...this.helper.doubleLineOps(o[0],o[1],c[0],c[1],s))}})),h}}class f{constructor(t){this.helper=t}fillPolygon(t,s){const e=s.hachureGap<0?4*s.strokeWidth:s.hachureGap,i=s.zigzagOffset<0?e:s.zigzagOffset,a=n(t,s=Object.assign({},s,{hachureGap:e+i}));return{type:"fillSketch",ops:this.zigzagLines(a,i,s)}}zigzagLines(t,s,e){const a=[];return t.forEach((t=>{const h=i(t),l=Math.round(h/(2*s));let o=t[0],r=t[1];o[0]>r[0]&&(o=t[1],r=t[0]);const n=Math.atan((r[1]-o[1])/(r[0]-o[0]));for(let t=0;t<l;t++){const i=2*t*s,h=2*(t+1)*s,l=Math.sqrt(2*Math.pow(s,2)),r=[o[0]+i*Math.cos(n),o[1]+i*Math.sin(n)],c=[o[0]+h*Math.cos(n),o[1]+h*Math.sin(n)],d=[r[0]+l*Math.cos(n+Math.PI/4),r[1]+l*Math.sin(n+Math.PI/4)];a.push(...this.helper.doubleLineOps(r[0],r[1],d[0],d[1],e),...this.helper.doubleLineOps(d[0],d[1],c[0],c[1],e))}})),a}}const m={};class y{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const b={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function x(t,s){return t.type===s}function k(t){const s=[],e=function(t){const s=new Array;for(;""!==t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))s[s.length]={type:0,text:RegExp.$1},t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];s[s.length]={type:1,text:""+parseFloat(RegExp.$1)},t=t.substr(RegExp.$1.length)}return s[s.length]={type:2,text:""},s}(t);let i="BOD",a=0,h=e[a];for(;!x(h,2);){let l=0;const o=[];if("BOD"===i){if("M"!==h.text&&"m"!==h.text)return k("M0,0"+t);a++,l=b[h.text],i=h.text}else x(h,1)?l=b[i]:(a++,l=b[h.text],i=h.text);if(!(a+l<e.length))throw new Error("Path data ended short");for(let t=a;t<a+l;t++){const s=e[t];if(!x(s,1))throw new Error("Param not a number: "+i+","+s.text);o[o.length]=+s.text}if("number"!=typeof b[i])throw new Error("Bad segment: "+i);{const t={key:i,data:o};s.push(t),a+=l,h=e[a],"M"===i&&(i="L"),"m"===i&&(i="l")}}return s}function S(t){let s=0,e=0,i=0,a=0;const h=[];for(const{key:l,data:o}of t)switch(l){case"M":h.push({key:"M",data:[...o]}),[s,e]=o,[i,a]=o;break;case"m":s+=o[0],e+=o[1],h.push({key:"M",data:[s,e]}),i=s,a=e;break;case"L":h.push({key:"L",data:[...o]}),[s,e]=o;break;case"l":s+=o[0],e+=o[1],h.push({key:"L",data:[s,e]});break;case"C":h.push({key:"C",data:[...o]}),s=o[4],e=o[5];break;case"c":{const t=o.map(((t,i)=>i%2?t+e:t+s));h.push({key:"C",data:t}),s=t[4],e=t[5];break}case"Q":h.push({key:"Q",data:[...o]}),s=o[2],e=o[3];break;case"q":{const t=o.map(((t,i)=>i%2?t+e:t+s));h.push({key:"Q",data:t}),s=t[2],e=t[3];break}case"A":h.push({key:"A",data:[...o]}),s=o[5],e=o[6];break;case"a":s+=o[5],e+=o[6],h.push({key:"A",data:[o[0],o[1],o[2],o[3],o[4],s,e]});break;case"H":h.push({key:"H",data:[...o]}),s=o[0];break;case"h":s+=o[0],h.push({key:"H",data:[s]});break;case"V":h.push({key:"V",data:[...o]}),e=o[0];break;case"v":e+=o[0],h.push({key:"V",data:[e]});break;case"S":h.push({key:"S",data:[...o]}),s=o[2],e=o[3];break;case"s":{const t=o.map(((t,i)=>i%2?t+e:t+s));h.push({key:"S",data:t}),s=t[2],e=t[3];break}case"T":h.push({key:"T",data:[...o]}),s=o[0],e=o[1];break;case"t":s+=o[0],e+=o[1],h.push({key:"T",data:[s,e]});break;case"Z":case"z":h.push({key:"Z",data:[]}),s=i,e=a}return h}function v(t){const s=[];let e="",i=0,a=0,h=0,l=0,o=0,r=0;for(const{key:n,data:c}of t){switch(n){case"M":s.push({key:"M",data:[...c]}),[i,a]=c,[h,l]=c;break;case"C":s.push({key:"C",data:[...c]}),i=c[4],a=c[5],o=c[2],r=c[3];break;case"L":s.push({key:"L",data:[...c]}),[i,a]=c;break;case"H":i=c[0],s.push({key:"L",data:[i,a]});break;case"V":a=c[0],s.push({key:"L",data:[i,a]});break;case"S":{let t=0,h=0;"C"===e||"S"===e?(t=i+(i-o),h=a+(a-r)):(t=i,h=a),s.push({key:"C",data:[t,h,...c]}),o=c[0],r=c[1],i=c[2],a=c[3];break}case"T":{const[t,h]=c;let l=0,n=0;"Q"===e||"T"===e?(l=i+(i-o),n=a+(a-r)):(l=i,n=a);const d=i+2*(l-i)/3,u=a+2*(n-a)/3,g=t+2*(l-t)/3,p=h+2*(n-h)/3;s.push({key:"C",data:[d,u,g,p,t,h]}),o=l,r=n,i=t,a=h;break}case"Q":{const[t,e,h,l]=c,n=i+2*(t-i)/3,d=a+2*(e-a)/3,u=h+2*(t-h)/3,g=l+2*(e-l)/3;s.push({key:"C",data:[n,d,u,g,h,l]}),o=t,r=e,i=h,a=l;break}case"A":{const t=Math.abs(c[0]),e=Math.abs(c[1]),h=c[2],l=c[3],o=c[4],r=c[5],n=c[6];0===t||0===e?(s.push({key:"C",data:[i,a,r,n,r,n]}),i=r,a=n):i===r&&a===n||(F(i,a,r,n,t,e,h,l,o).forEach((function(t){s.push({key:"C",data:t})})),i=r,a=n);break}case"Z":s.push({key:"Z",data:[]}),i=h,a=l}e=n}return s}function A(t,s,e){return[t*Math.cos(e)-s*Math.sin(e),t*Math.sin(e)+s*Math.cos(e)]}function F(t,s,e,i,a,h,l,o,r,n){const c=(d=l,Math.PI*d/180);var d;let u=[],g=0,p=0,f=0,m=0;if(n)[g,p,f,m]=n;else{[t,s]=A(t,s,-c),[e,i]=A(e,i,-c);const l=(t-e)/2,n=(s-i)/2;let d=l*l/(a*a)+n*n/(h*h);d>1&&(d=Math.sqrt(d),a*=d,h*=d);const u=a*a,y=h*h,b=u*y-u*n*n-y*l*l,x=u*n*n+y*l*l,k=(o===r?-1:1)*Math.sqrt(Math.abs(b/x));f=k*a*n/h+(t+e)/2,m=k*-h*l/a+(s+i)/2,g=Math.asin(parseFloat(((s-m)/h).toFixed(9))),p=Math.asin(parseFloat(((i-m)/h).toFixed(9))),t<f&&(g=Math.PI-g),e<f&&(p=Math.PI-p),g<0&&(g=2*Math.PI+g),p<0&&(p=2*Math.PI+p),r&&g>p&&(g-=2*Math.PI),!r&&p>g&&(p-=2*Math.PI)}let y=p-g;if(Math.abs(y)>120*Math.PI/180){const t=p,s=e,o=i;p=r&&p>g?g+120*Math.PI/180*1:g+120*Math.PI/180*-1,u=F(e=f+a*Math.cos(p),i=m+h*Math.sin(p),s,o,a,h,l,0,r,[p,t,f,m])}y=p-g;const b=Math.cos(g),x=Math.sin(g),k=Math.cos(p),S=Math.sin(p),v=Math.tan(y/4),w=4/3*a*v,M=4/3*h*v,C=[t,s],W=[t+w*x,s-M*b],z=[e+w*S,i-M*k],O=[e,i];if(W[0]=2*C[0]-W[0],W[1]=2*C[1]-W[1],n)return[W,z,O].concat(u);{u=[W,z,O].concat(u);const t=[];for(let s=0;s<u.length;s+=3){const e=A(u[s][0],u[s][1],c),i=A(u[s+1][0],u[s+1][1],c),a=A(u[s+2][0],u[s+2][1],c);t.push([e[0],e[1],i[0],i[1],a[0],a[1]])}return t}}const w={randOffset:function(t,s){return I(t,s)},randOffsetWithRange:function(t,s,e){return R(t,s,e)},ellipse:function(t,s,e,i,a){return z(t,s,a,W(e,i,a)).opset},doubleLineOps:function(t,s,e,i,a){return $(t,s,e,i,a,!0)}};function M(t,s,e,i,a){return{type:"path",ops:$(t,s,e,i,a)}}function C(t,s,e){const i=(t||[]).length;if(i>2){const a=[];for(let s=0;s<i-1;s++)a.push(...$(t[s][0],t[s][1],t[s+1][0],t[s+1][1],e));return s&&a.push(...$(t[i-1][0],t[i-1][1],t[0][0],t[0][1],e)),{type:"path",ops:a}}return 2===i?M(t[0][0],t[0][1],t[1][0],t[1][1],e):{type:"path",ops:[]}}function W(t,s,e){const i=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(t/2,2)+Math.pow(s/2,2))/2)),a=Math.max(e.curveStepCount,e.curveStepCount/Math.sqrt(200)*i),h=2*Math.PI/a;let l=Math.abs(t/2),o=Math.abs(s/2);const r=1-e.curveFitting;return l+=I(l*r,e),o+=I(o*r,e),{increment:h,rx:l,ry:o}}function z(t,s,e,i){const[a,h]=T(i.increment,t,s,i.rx,i.ry,1,i.increment*R(.1,R(.4,1,e),e),e);let l=E(a,null,e);if(!e.disableMultiStroke){const[a]=T(i.increment,t,s,i.rx,i.ry,1.5,0,e),h=E(a,null,e);l=l.concat(h)}return{estimatedPoints:h,opset:{type:"path",ops:l}}}function O(t,s,e,i,a,h,l,o,r){const n=t,c=s;let d=Math.abs(e/2),u=Math.abs(i/2);d+=I(.01*d,r),u+=I(.01*u,r);let g=a,p=h;for(;g<0;)g+=2*Math.PI,p+=2*Math.PI;p-g>2*Math.PI&&(g=0,p=2*Math.PI);const f=2*Math.PI/r.curveStepCount,m=Math.min(f/2,(p-g)/2),y=_(m,n,c,d,u,g,p,1,r);if(!r.disableMultiStroke){const t=_(m,n,c,d,u,g,p,1.5,r);y.push(...t)}return l&&(o?y.push(...$(n,c,n+d*Math.cos(g),c+u*Math.sin(g),r),...$(n,c,n+d*Math.cos(p),c+u*Math.sin(p),r)):y.push({op:"lineTo",data:[n,c]},{op:"lineTo",data:[n+d*Math.cos(g),c+u*Math.sin(g)]})),{type:"path",ops:y}}function L(t,s){const e=[];if(t.length){const i=s.maxRandomnessOffset||0,a=t.length;if(a>2){e.push({op:"move",data:[t[0][0]+I(i,s),t[0][1]+I(i,s)]});for(let h=1;h<a;h++)e.push({op:"lineTo",data:[t[h][0]+I(i,s),t[h][1]+I(i,s)]})}}return{type:"fillPath",ops:e}}function j(t,s){return function(t,s){let e=t.fillStyle||"hachure";if(!m[e])switch(e){case"zigzag":m[e]||(m[e]=new d(s));break;case"cross-hatch":m[e]||(m[e]=new u(s));break;case"dots":m[e]||(m[e]=new g(s));break;case"dashed":m[e]||(m[e]=new p(s));break;case"zigzag-line":m[e]||(m[e]=new f(s));break;case"hachure":default:e="hachure",m[e]||(m[e]=new c(s))}return m[e]}(s,w).fillPolygon(t,s)}function P(t){return t.randomizer||(t.randomizer=new y(t.seed||0)),t.randomizer.next()}function R(t,s,e,i=1){return e.roughness*i*(P(e)*(s-t)+t)}function I(t,s,e=1){return R(-t,t,s,e)}function $(t,s,e,i,a,h=!1){const l=h?a.disableMultiStrokeFill:a.disableMultiStroke,o=V(t,s,e,i,a,!0,!1);if(l)return o;const r=V(t,s,e,i,a,!0,!0);return o.concat(r)}function V(t,s,e,i,a,h,l){const o=Math.pow(t-e,2)+Math.pow(s-i,2),r=Math.sqrt(o);let n=1;n=r<200?1:r>500?.4:-.0016668*r+1.233334;let c=a.maxRandomnessOffset||0;c*c*100>o&&(c=r/10);const d=c/2,u=.2+.2*P(a);let g=a.bowing*a.maxRandomnessOffset*(i-s)/200,p=a.bowing*a.maxRandomnessOffset*(t-e)/200;g=I(g,a,n),p=I(p,a,n);const f=[],m=()=>I(d,a,n),y=()=>I(c,a,n);return h&&(l?f.push({op:"move",data:[t+m(),s+m()]}):f.push({op:"move",data:[t+I(c,a,n),s+I(c,a,n)]})),l?f.push({op:"bcurveTo",data:[g+t+(e-t)*u+m(),p+s+(i-s)*u+m(),g+t+2*(e-t)*u+m(),p+s+2*(i-s)*u+m(),e+m(),i+m()]}):f.push({op:"bcurveTo",data:[g+t+(e-t)*u+y(),p+s+(i-s)*u+y(),g+t+2*(e-t)*u+y(),p+s+2*(i-s)*u+y(),e+y(),i+y()]}),f}function G(t,s,e){const i=[];i.push([t[0][0]+I(s,e),t[0][1]+I(s,e)]),i.push([t[0][0]+I(s,e),t[0][1]+I(s,e)]);for(let a=1;a<t.length;a++)i.push([t[a][0]+I(s,e),t[a][1]+I(s,e)]),a===t.length-1&&i.push([t[a][0]+I(s,e),t[a][1]+I(s,e)]);return E(i,null,e)}function E(t,s,e){const i=t.length,a=[];if(i>3){const h=[],l=1-e.curveTightness;a.push({op:"move",data:[t[1][0],t[1][1]]});for(let s=1;s+2<i;s++){const e=t[s];h[0]=[e[0],e[1]],h[1]=[e[0]+(l*t[s+1][0]-l*t[s-1][0])/6,e[1]+(l*t[s+1][1]-l*t[s-1][1])/6],h[2]=[t[s+1][0]+(l*t[s][0]-l*t[s+2][0])/6,t[s+1][1]+(l*t[s][1]-l*t[s+2][1])/6],h[3]=[t[s+1][0],t[s+1][1]],a.push({op:"bcurveTo",data:[h[1][0],h[1][1],h[2][0],h[2][1],h[3][0],h[3][1]]})}if(s&&2===s.length){const t=e.maxRandomnessOffset;a.push({op:"lineTo",data:[s[0]+I(t,e),s[1]+I(t,e)]})}}else 3===i?(a.push({op:"move",data:[t[1][0],t[1][1]]}),a.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):2===i&&a.push(...$(t[0][0],t[0][1],t[1][0],t[1][1],e));return a}function T(t,s,e,i,a,h,l,o){const r=[],n=[],c=I(.5,o)-Math.PI/2;n.push([I(h,o)+s+.9*i*Math.cos(c-t),I(h,o)+e+.9*a*Math.sin(c-t)]);for(let l=c;l<2*Math.PI+c-.01;l+=t){const t=[I(h,o)+s+i*Math.cos(l),I(h,o)+e+a*Math.sin(l)];r.push(t),n.push(t)}return n.push([I(h,o)+s+i*Math.cos(c+2*Math.PI+.5*l),I(h,o)+e+a*Math.sin(c+2*Math.PI+.5*l)]),n.push([I(h,o)+s+.98*i*Math.cos(c+l),I(h,o)+e+.98*a*Math.sin(c+l)]),n.push([I(h,o)+s+.9*i*Math.cos(c+.5*l),I(h,o)+e+.9*a*Math.sin(c+.5*l)]),[n,r]}function _(t,s,e,i,a,h,l,o,r){const n=h+I(.1,r),c=[];c.push([I(o,r)+s+.9*i*Math.cos(n-t),I(o,r)+e+.9*a*Math.sin(n-t)]);for(let h=n;h<=l;h+=t)c.push([I(o,r)+s+i*Math.cos(h),I(o,r)+e+a*Math.sin(h)]);return c.push([s+i*Math.cos(l),e+a*Math.sin(l)]),c.push([s+i*Math.cos(l),e+a*Math.sin(l)]),E(c,null,r)}function B(t,s,e,i,a,h,l,o){const r=[],n=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.3];let c=[0,0];const d=o.disableMultiStroke?1:2;for(let u=0;u<d;u++)0===u?r.push({op:"move",data:[l[0],l[1]]}):r.push({op:"move",data:[l[0]+I(n[0],o),l[1]+I(n[0],o)]}),c=[a+I(n[u],o),h+I(n[u],o)],r.push({op:"bcurveTo",data:[t+I(n[u],o),s+I(n[u],o),e+I(n[u],o),i+I(n[u],o),c[0],c[1]]});return r}function D(t){return[...t]}function N(t,s){return Math.pow(t[0]-s[0],2)+Math.pow(t[1]-s[1],2)}function q(t,s,e){const i=N(s,e);if(0===i)return N(t,s);let a=((t[0]-s[0])*(e[0]-s[0])+(t[1]-s[1])*(e[1]-s[1]))/i;return a=Math.max(0,Math.min(1,a)),N(t,Y(s,e,a))}function Y(t,s,e){return[t[0]+(s[0]-t[0])*e,t[1]+(s[1]-t[1])*e]}function X(t,s,e,i){const a=i||[];if(function(t,s){const e=t[s+0],i=t[s+1],a=t[s+2],h=t[s+3];let l=3*i[0]-2*e[0]-h[0];l*=l;let o=3*i[1]-2*e[1]-h[1];o*=o;let r=3*a[0]-2*h[0]-e[0];r*=r;let n=3*a[1]-2*h[1]-e[1];return n*=n,l<r&&(l=r),o<n&&(o=n),l+o}(t,s)<e){const e=t[s+0];a.length?(h=a[a.length-1],l=e,Math.sqrt(N(h,l))>1&&a.push(e)):a.push(e),a.push(t[s+3])}else{const i=.5,h=t[s+0],l=t[s+1],o=t[s+2],r=t[s+3],n=Y(h,l,i),c=Y(l,o,i),d=Y(o,r,i),u=Y(n,c,i),g=Y(c,d,i),p=Y(u,g,i);X([h,n,u,p],0,e,a),X([p,g,d,r],0,e,a)}var h,l;return a}function H(t,s){return Z(t,0,t.length,s)}function Z(t,s,e,i,a){const h=a||[],l=t[s],o=t[e-1];let r=0,n=1;for(let i=s+1;i<e-1;++i){const s=q(t[i],l,o);s>r&&(r=s,n=i)}return Math.sqrt(r)>i?(Z(t,s,n+1,i,h),Z(t,n,e,i,h)):(h.length||h.push(l),h.push(o)),h}function Q(t,s=.15,e){const i=[],a=(t.length-1)/3;for(let e=0;e<a;e++)X(t,3*e,s,i);return e&&e>0?Z(i,0,i.length,e):i}const K="none";class J{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,combineNestedSvgPaths:!1,disableMultiStroke:!1,disableMultiStrokeFill:!1},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,s,e){return{shape:t,sets:s||[],options:e||this.defaultOptions}}line(t,s,e,i,a){const h=this._o(a);return this._d("line",[M(t,s,e,i,h)],h)}rectangle(t,s,e,i,a){const h=this._o(a),l=[],o=function(t,s,e,i,a){return function(t,s){return C(t,!0,s)}([[t,s],[t+e,s],[t+e,s+i],[t,s+i]],a)}(t,s,e,i,h);if(h.fill){const a=[[t,s],[t+e,s],[t+e,s+i],[t,s+i]];"solid"===h.fillStyle?l.push(L(a,h)):l.push(j(a,h))}return h.stroke!==K&&l.push(o),this._d("rectangle",l,h)}ellipse(t,s,e,i,a){const h=this._o(a),l=[],o=W(e,i,h),r=z(t,s,h,o);if(h.fill)if("solid"===h.fillStyle){const e=z(t,s,h,o).opset;e.type="fillPath",l.push(e)}else l.push(j(r.estimatedPoints,h));return h.stroke!==K&&l.push(r.opset),this._d("ellipse",l,h)}circle(t,s,e,i){const a=this.ellipse(t,s,e,e,i);return a.shape="circle",a}linearPath(t,s){const e=this._o(s);return this._d("linearPath",[C(t,!1,e)],e)}arc(t,s,e,i,a,h,l=!1,o){const r=this._o(o),n=[],c=O(t,s,e,i,a,h,l,!0,r);if(l&&r.fill)if("solid"===r.fillStyle){const l=O(t,s,e,i,a,h,!0,!1,r);l.type="fillPath",n.push(l)}else n.push(function(t,s,e,i,a,h,l){const o=t,r=s;let n=Math.abs(e/2),c=Math.abs(i/2);n+=I(.01*n,l),c+=I(.01*c,l);let d=a,u=h;for(;d<0;)d+=2*Math.PI,u+=2*Math.PI;u-d>2*Math.PI&&(d=0,u=2*Math.PI);const g=(u-d)/l.curveStepCount,p=[];for(let t=d;t<=u;t+=g)p.push([o+n*Math.cos(t),r+c*Math.sin(t)]);return p.push([o+n*Math.cos(u),r+c*Math.sin(u)]),p.push([o,r]),j(p,l)}(t,s,e,i,a,h,r));return r.stroke!==K&&n.push(c),this._d("arc",n,r)}curve(t,s){const e=this._o(s),i=[],a=function(t,s){let e=G(t,1*(1+.2*s.roughness),s);if(!s.disableMultiStroke){const i=G(t,1.5*(1+.22*s.roughness),function(t){const s=Object.assign({},t);return s.randomizer=void 0,t.seed&&(s.seed=t.seed+1),s}(s));e=e.concat(i)}return{type:"path",ops:e}}(t,e);if(e.fill&&e.fill!==K&&t.length>=3){const s=Q(function(t,s=0){const e=t.length;if(e<3)throw new Error("A curve must have at least three points.");const i=[];if(3===e)i.push(D(t[0]),D(t[1]),D(t[2]),D(t[2]));else{const e=[];e.push(t[0],t[0]);for(let s=1;s<t.length;s++)e.push(t[s]),s===t.length-1&&e.push(t[s]);const a=[],h=1-s;i.push(D(e[0]));for(let t=1;t+2<e.length;t++){const s=e[t];a[0]=[s[0],s[1]],a[1]=[s[0]+(h*e[t+1][0]-h*e[t-1][0])/6,s[1]+(h*e[t+1][1]-h*e[t-1][1])/6],a[2]=[e[t+1][0]+(h*e[t][0]-h*e[t+2][0])/6,e[t+1][1]+(h*e[t][1]-h*e[t+2][1])/6],a[3]=[e[t+1][0],e[t+1][1]],i.push(a[1],a[2],a[3])}}return i}(t),10,(1+e.roughness)/2);"solid"===e.fillStyle?i.push(L(s,e)):i.push(j(s,e))}return e.stroke!==K&&i.push(a),this._d("curve",i,e)}polygon(t,s){const e=this._o(s),i=[],a=C(t,!0,e);return e.fill&&("solid"===e.fillStyle?i.push(L(t,e)):i.push(j(t,e))),e.stroke!==K&&i.push(a),this._d("polygon",i,e)}path(t,s){const e=this._o(s),i=[];if(!t)return this._d("path",i,e);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const a=e.fill&&"transparent"!==e.fill&&e.fill!==K,h=e.stroke!==K,l=!!(e.simplification&&e.simplification<1),o=function(t,s,e){const i=v(S(k(t))),a=[];let h=[],l=[0,0],o=[];const r=()=>{o.length>=4&&h.push(...Q(o,1)),o=[]},n=()=>{r(),h.length&&(a.push(h),h=[])};for(const{key:t,data:s}of i)switch(t){case"M":n(),l=[s[0],s[1]],h.push(l);break;case"L":r(),h.push([s[0],s[1]]);break;case"C":if(!o.length){const t=h.length?h[h.length-1]:l;o.push([t[0],t[1]])}o.push([s[0],s[1]]),o.push([s[2],s[3]]),o.push([s[4],s[5]]);break;case"Z":r(),h.push([l[0],l[1]])}if(n(),!e)return a;const c=[];for(const t of a){const s=H(t,e);s.length&&c.push(s)}return c}(t,0,l?4-4*e.simplification:(1+e.roughness)/2);if(a)if(e.combineNestedSvgPaths){const t=[];o.forEach((s=>t.push(...s))),"solid"===e.fillStyle?i.push(L(t,e)):i.push(j(t,e))}else o.forEach((t=>{"solid"===e.fillStyle?i.push(L(t,e)):i.push(j(t,e))}));return h&&(l?o.forEach((t=>{i.push(C(t,!1,e))})):i.push(function(t,s){const e=v(S(k(t))),i=[];let a=[0,0],h=[0,0];for(const{key:t,data:l}of e)switch(t){case"M":{const t=1*(s.maxRandomnessOffset||0);i.push({op:"move",data:l.map((e=>e+I(t,s)))}),h=[l[0],l[1]],a=[l[0],l[1]];break}case"L":i.push(...$(h[0],h[1],l[0],l[1],s)),h=[l[0],l[1]];break;case"C":{const[t,e,a,o,r,n]=l;i.push(...B(t,e,a,o,r,n,h,s)),h=[r,n];break}case"Z":i.push(...$(h[0],h[1],a[0],a[1],s)),h=[a[0],a[1]]}return{type:"path",ops:i}}(t,e))),this._d("path",i,e)}opsToPath(t){let s="";for(const e of t.ops){const t=e.data;switch(e.op){case"move":s+=`M${t[0]} ${t[1]} `;break;case"bcurveTo":s+=`C${t[0]} ${t[1]}, ${t[2]} ${t[3]}, ${t[4]} ${t[5]} `;break;case"lineTo":s+=`L${t[0]} ${t[1]} `}}return s.trim()}toPaths(t){const s=t.sets||[],e=t.options||this.defaultOptions,i=[];for(const t of s){let s=null;switch(t.type){case"path":s={d:this.opsToPath(t),stroke:e.stroke,strokeWidth:e.strokeWidth,fill:K};break;case"fillPath":s={d:this.opsToPath(t),stroke:K,strokeWidth:0,fill:e.fill||K};break;case"fillSketch":s=this.fillSketch(t,e)}s&&i.push(s)}return i}fillSketch(t,s){let e=s.fillWeight;return e<0&&(e=s.strokeWidth/2),{d:this.opsToPath(t),stroke:s.fill||K,strokeWidth:e,fill:K}}}const U="http://www.w3.org/2000/svg";class tt{constructor(t,s){this.svg=t,this.gen=new J(s)}draw(t){const s=t.sets||[],e=t.options||this.getDefaultOptions(),i=this.svg.ownerDocument||window.document,a=i.createElementNS(U,"g");for(const h of s){let s=null;switch(h.type){case"path":s=i.createElementNS(U,"path"),s.setAttribute("d",this.opsToPath(h)),s.setAttribute("stroke",e.stroke),s.setAttribute("stroke-width",e.strokeWidth+""),s.setAttribute("fill","none"),e.strokeLineDash&&s.setAttribute("stroke-dasharray",e.strokeLineDash.join(" ").trim()),e.strokeLineDashOffset&&s.setAttribute("stroke-dashoffset",""+e.strokeLineDashOffset);break;case"fillPath":s=i.createElementNS(U,"path"),s.setAttribute("d",this.opsToPath(h)),s.setAttribute("stroke","none"),s.setAttribute("stroke-width","0"),s.setAttribute("fill",e.fill||""),"curve"!==t.shape&&"polygon"!==t.shape||s.setAttribute("fill-rule","evenodd");break;case"fillSketch":s=this.fillSketch(i,h,e)}s&&a.appendChild(s)}return a}fillSketch(t,s,e){let i=e.fillWeight;i<0&&(i=e.strokeWidth/2);const a=t.createElementNS(U,"path");return a.setAttribute("d",this.opsToPath(s)),a.setAttribute("stroke",e.fill||""),a.setAttribute("stroke-width",i+""),a.setAttribute("fill","none"),e.fillLineDash&&a.setAttribute("stroke-dasharray",e.fillLineDash.join(" ").trim()),e.fillLineDashOffset&&a.setAttribute("stroke-dashoffset",""+e.fillLineDashOffset),a}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t){return this.gen.opsToPath(t)}line(t,s,e,i,a){const h=this.gen.line(t,s,e,i,a);return this.draw(h)}rectangle(t,s,e,i,a){const h=this.gen.rectangle(t,s,e,i,a);return this.draw(h)}ellipse(t,s,e,i,a){const h=this.gen.ellipse(t,s,e,i,a);return this.draw(h)}circle(t,s,e,i){const a=this.gen.circle(t,s,e,i);return this.draw(a)}linearPath(t,s){const e=this.gen.linearPath(t,s);return this.draw(e)}polygon(t,s){const e=this.gen.polygon(t,s);return this.draw(e)}arc(t,s,e,i,a,h,l=!1,o){const r=this.gen.arc(t,s,e,i,a,h,l,o);return this.draw(r)}curve(t,s){const e=this.gen.curve(t,s);return this.draw(e)}path(t,s){const e=this.gen.path(t,s);return this.draw(e)}}var st=(t,s)=>new tt(t,s);function et(t,s,e){const i=s.split(".");let a=t;return i.forEach((t=>{a="object"==typeof a&&Object.keys(a).includes(t)?a[t]:void 0})),a||e}let it=[];const at=t=>{Array.isArray(t)||(t=t?[t]:[]),t.filter((t=>!it.includes(t))).forEach((s=>(t=>{let s=document.createElement("link");s.id="rough-viz-font-"+t,s.rel="stylesheet",s.href=(t=>`https://fonts.googleapis.com/css2?family=${t.replace(/ /g,"+")}&display=swap`)(t),s.crossorigin=!0,document.querySelector("head").appendChild(s),it.push(t)})(t)))};class ht{constructor(t){this.el=t.element,this.element=t.element,this.title=t.title,this.titleFontSize=t.titleFontSize,this.font=et(t,"font",0),this.fillStyle=t.fillStyle,this.tooltipFontSize=et(t,"tooltipFontSize","0.95rem"),this.bowing=et(t,"bowing",0),this.simplification=et(t,"simplification",.2),this.interactive=!1!==t.interactive,this.dataFormat="object"==typeof t.data?"object":"file"}setSvg(){this.svg=s.select(this.el).append("svg").attr("viewBox",`0 0 ${this.width+this.margin.left+this.margin.right}\n       ${this.height+this.margin.top+this.margin.bottom}`).append("g").attr("id",this.roughId).attr("transform","translate("+this.margin.left+","+this.margin.top+")")}resolveFont(){0===this.font||void 0===this.font||"gaegu"===this.font.toString().toLowerCase()?(at("Gaegu"),this.fontFamily="Gaegu"):1===this.font||"indie flower"===this.font.toString().toLowerCase()?(at("Indie Flower"),this.fontFamily="Indie Flower"):this.fontFamily=this.font}}const lt=({roughness:t,ceiling:s=20,defaultValue:e=1})=>void 0===t||"number"!=typeof t?e:t>s?s:t;class ot extends ht{constructor(t){super(t),this.data=t.data,this.margin=t.margin||{top:50,right:20,bottom:70,left:100},this.color=et(t,"color","skyblue"),this.highlight=et(t,"highlight","coral"),this.roughness=lt({roughness:t.roughness}),this.stroke=et(t,"stroke","black"),this.strokeWidth=et(t,"strokeWidth",1),this.axisStrokeWidth=et(t,"axisStrokeWidth",.5),this.axisRoughness=et(t,"axisRoughness",.5),this.innerStrokeWidth=et(t,"innerStrokeWidth",1),this.fillWeight=et(t,"fillWeight",.5),this.axisFontSize=t.axisFontSize,this.labels="object"===this.dataFormat?"labels":t.labels,this.values="object"===this.dataFormat?"values":t.values,this.xValueFormat=t.xValueFormat,this.yValueFormat=t.yValueFormat,this.padding=et(t,"padding",.1),this.xLabel=et(t,"xLabel",""),this.yLabel=et(t,"yLabel",""),this.labelFontSize=et(t,"labelFontSize","1rem"),this.initChartValues(t),this.resolveFont(),this.drawChart=this.resolveData(t.data),this.drawChart(),"undefined"!==t.title&&this.setTitle(t.title)}initChartValues(t){const s=t.width?t.width:350,e=t.height?t.height:450;this.width=s-this.margin.left-this.margin.right,this.height=e-this.margin.top-this.margin.bottom,this.roughId=this.el+"_svg",this.graphClass=this.el.substring(1,this.el.length),this.interactionG="g."+this.graphClass,this.setSvg()}resolveData(t){return"string"!=typeof t?()=>{this.data=t,this.drawFromObject()}:t.includes(".csv")?()=>{s.csv(t).then((t=>{this.data=t,this.drawFromFile()}))}:t.includes(".tsv")?()=>{s.tsv(t).then((t=>{this.data=t,this.drawFromFile()}))}:void 0}addScales(){const t=this;this.xScale=s.scaleBand().rangeRound([0,this.width]).padding(this.padding).domain("file"===this.dataFormat?this.data.map((s=>s[t.labels])):this.data[t.labels]),this.yScale=s.scaleLinear().rangeRound([this.height,0]).domain("file"===this.dataFormat?[0,s.max(this.data,(s=>+s[t.values]))]:[0,s.max(this.data[t.values])])}addLabels(){""!==this.xLabel&&this.svg.append("text").attr("x",this.width/2).attr("y",this.height+this.margin.bottom/2).attr("dx","1em").attr("class","labelText").style("text-anchor","middle").style("font-family",this.fontFamily).style("font-size",this.labelFontSize).text(this.xLabel),""!==this.yLabel&&this.svg.append("text").attr("transform","rotate(-90)").attr("y",0-this.margin.left/1.4).attr("x",0-this.height/2).attr("dy","1em").attr("class","labelText").style("text-anchor","middle").style("font-family",this.fontFamily).style("font-size",this.labelFontSize).text(this.yLabel)}addAxes(){const t=s.axisBottom(this.xScale).tickSize(0).tickFormat((t=>this.xValueFormat?s.format(this.xValueFormat)(t):t)),e=s.axisLeft(this.yScale).tickSize(0).tickFormat((t=>this.yValueFormat?s.format(this.yValueFormat)(t):t));this.svg.append("g").attr("transform","translate(0,"+this.height+")").call(t).attr("class","xAxis"+this.graphClass).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end").style("font-family",this.fontFamily).style("font-size",void 0===this.axisFontSize?Math.min(.8,Math.min(this.width,this.height)/140)+"rem":this.axisFontSize).style("opacity",.9),this.svg.append("g").call(e).attr("class","yAxis"+this.graphClass).selectAll("text").style("font-family",this.fontFamily).style("font-size",void 0===this.axisFontSize?Math.min(.95,Math.min(this.width,this.height)/140)+"rem":this.axisFontSize).style("opacity",.9),s.selectAll("path.domain").attr("stroke","transparent")}makeAxesRough(t,e){const i="xAxis"+this.graphClass,a="yAxis"+this.graphClass,h="rough-"+i,l="rough-"+a;s.select("."+i).selectAll("path.domain").each(((i,a)=>{const l=s.select(this).node().getAttribute("d"),o=e.path(l,{fillStyle:"hachure"});o.setAttribute("class",h),t.appendChild(o)})),s.selectAll("."+h).attr("transform",`translate(0, ${this.height})`),s.select("."+a).selectAll("path.domain").each(((i,a)=>{const h=s.select(this).node().getAttribute("d"),o=e.path(h,{fillStyle:"hachure"});o.setAttribute("class",l),t.appendChild(o)}))}setTitle(t){this.svg.append("text").attr("x",this.width/2).attr("y",0-this.margin.top/2).attr("class","title").attr("text-anchor","middle").style("font-size",void 0===this.titleFontSize?Math.min(40,Math.min(this.width,this.height)/5)+"px":this.titleFontSize).style("font-family",this.fontFamily).style("opacity",.8).text(t)}addInteraction(){s.selectAll(this.interactionG).data("file"===this.dataFormat?this.data:this.data.values).append("rect").attr("x",((t,s)=>"file"===this.dataFormat?this.xScale(t[this.labels]):this.xScale(this.data[this.labels][s]))).attr("y",((t,s)=>"file"===this.dataFormat?this.yScale(+t[this.values]):this.yScale(this.data[this.values][s]))).attr("width",this.xScale.bandwidth()).attr("height",((t,s)=>"file"===this.dataFormat?this.height-this.yScale(+t[this.values]):this.height-this.yScale(this.data[this.values][s]))).attr("fill","transparent");const t=s.select(this.el).append("div").style("opacity",0).attr("class","tooltip").style("position","absolute").style("background-color","white").style("border","solid").style("border-width","1px").style("border-radius","5px").style("padding","3px").style("font-family",this.fontFamily).style("font-size",this.tooltipFontSize).style("pointer-events","none");const e=this;s.selectAll(this.interactionG).on("mouseover",(function(){t.style("opacity",1),s.select(this).select("path").style("stroke",e.highlight),s.select(this).selectAll("path:nth-child(2)").style("stroke-width",e.strokeWidth+1.2)})),s.selectAll(this.interactionG).on("mouseout",(function(){t.style("opacity",0),s.select(this).select("path").style("stroke",e.color),s.select(this).selectAll("path:nth-child(2)").style("stroke-width",e.strokeWidth)})),s.selectAll(this.interactionG).on("mousemove",(function(i){const a=s.select(this).attr("attrX"),h=s.select(this).attr("attrY"),l=s.mouse(this);t.html(`<b>${a}</b>: ${h}`).style("opacity",.95).attr("class",(function(t){})).style("transform",`translate(${l[0]+e.margin.left}px, \n          ${l[1]-(e.height+e.margin.top+e.margin.bottom)}px)`)}))}initRoughObjects(){this.roughSvg=document.getElementById(this.roughId),this.rcAxis=st(this.roughSvg,{options:{strokeWidth:this.axisStrokeWidth,roughness:this.axisRoughness}}),this.rc=st(this.roughSvg,{options:{fill:this.color,stroke:"none"===this.stroke?void 0:this.stroke,strokeWidth:this.innerStrokeWidth,roughness:this.roughness,bowing:this.bowing,fillStyle:this.fillStyle}})}drawFromObject(){this.initRoughObjects(),this.addScales(),this.addAxes(),this.makeAxesRough(this.roughSvg,this.rcAxis),this.addLabels(),this.data.values.forEach(((t,s)=>{const e=this.rc.rectangle(this.xScale(this.data[this.labels][s]),this.yScale(+t),this.xScale.bandwidth(),this.height-this.yScale(+t),{simplification:this.simplification,fillWeight:this.fillWeight}),i=this.roughSvg.appendChild(e);i.setAttribute("class",this.graphClass),i.setAttribute("attrX",this.data[this.labels][s]),i.setAttribute("attrY",+t)})),s.selectAll(this.interactionG).selectAll("path:nth-child(2)").style("stroke-width",this.strokeWidth),!0===this.interactive&&this.addInteraction()}drawFromFile(){this.initRoughObjects(),this.addScales(),this.addAxes(),this.makeAxesRough(this.roughSvg,this.rcAxis),this.addLabels(),this.data.forEach((t=>{const s=this.rc.rectangle(this.xScale(t[this.labels]),this.yScale(+t[this.values]),this.xScale.bandwidth(),this.height-this.yScale(+t[this.values]),{simplification:this.simplification,fillWeight:this.fillWeight}),e=this.roughSvg.appendChild(s);e.setAttribute("class",this.graphClass),e.setAttribute("attrX",t[this.labels]),e.setAttribute("attrY",+t[this.values])})),s.selectAll(this.interactionG).selectAll("path:nth-child(2)").style("stroke-width",this.strokeWidth),!0===this.interactive&&this.addInteraction()}}class rt extends ht{constructor(t){super(t),this.margin=t.margin||{top:50,right:20,bottom:50,left:100},this.color=et(t,"color","skyblue"),this.highlight=et(t,"highlight","coral"),this.roughness=lt({roughness:t.roughness}),this.stroke=et(t,"stroke","black"),this.strokeWidth=et(t,"strokeWidth",1),this.axisStrokeWidth=et(t,"axisStrokeWidth",.5),this.axisRoughness=et(t,"axisRoughness",.5),this.innerStrokeWidth=et(t,"innerStrokeWidth",1),this.fillWeight=et(t,"fillWeight",.5),this.axisFontSize=t.axisFontSize,this.labels="object"===this.dataFormat?"labels":t.labels,this.values="object"===this.dataFormat?"values":t.values,this.xValueFormat=t.xValueFormat,this.yValueFormat=t.yValueFormat,this.padding=et(t,"padding",.1),this.xLabel=et(t,"xLabel",""),this.yLabel=et(t,"yLabel",""),this.labelFontSize=et(t,"labelFontSize","1rem"),this.initChartValues(t),this.resolveFont(),this.drawChart=this.resolveData(t.data),this.drawChart(),"undefined"!==t.title&&this.setTitle(t.title)}initChartValues(t){const s=t.width?t.width:350,e=t.height?t.height:450;this.width=s-this.margin.left-this.margin.right,this.height=e-this.margin.top-this.margin.bottom,this.roughId=this.el+"_svg",this.graphClass=this.el.substring(1,this.el.length),this.interactionG="g."+this.graphClass,this.setSvg()}resolveData(t){return"string"!=typeof t?()=>{this.data=t,this.drawFromObject()}:t.includes(".csv")?()=>{s.csv(t).then((t=>{console.log(t),this.data=t,this.drawFromFile()}))}:t.includes(".tsv")?()=>{s.tsv(t).then((t=>{this.data=t,this.drawFromFile()}))}:void 0}addScales(){const t=this;this.yScale=s.scaleBand().rangeRound([0,this.height]).padding(this.padding).domain("file"===this.dataFormat?this.data.map((s=>s[t.labels])):this.data[t.labels]),this.xScale=s.scaleLinear().rangeRound([0,this.width]).domain("file"===this.dataFormat?[0,s.max(this.data,(s=>+s[t.values]))]:[0,s.max(this.data[t.values])])}addLabels(){""!==this.xLabel&&this.svg.append("text").attr("x",this.width/2).attr("y",this.height+this.margin.bottom/2.4).attr("dx","1em").attr("class","labelText").style("text-anchor","middle").style("font-family",this.fontFamily).style("font-size",this.labelFontSize).text(this.xLabel),""!==this.yLabel&&this.svg.append("text").attr("transform","rotate(-90)").attr("y",0-this.margin.left/1.5).attr("x",0-this.height/2).attr("dy","1em").attr("class","labelText").style("text-anchor","middle").style("font-family",this.fontFamily).style("font-size",this.labelFontSize).text(this.yLabel)}addAxes(){const t=s.axisBottom(this.xScale).tickSize(0).tickFormat((t=>this.xValueFormat?s.format(this.xValueFormat)(t):t)),e=s.axisLeft(this.yScale).tickSize(0).tickFormat((t=>this.yValueFormat?s.format(this.yValueFormat)(t):t));this.svg.append("g").attr("transform",`translate(0, ${this.height})`).call(t).attr("class","xAxis"+this.graphClass).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end").style("font-family",this.fontFamily).style("font-size",void 0===this.axisFontSize?Math.min(.95,Math.min(this.width,this.height)/140)+"rem":this.axisFontSize).style("opacity",.85),this.svg.append("g").call(e).attr("class","yAxis"+this.graphClass).selectAll("text").style("font-family",this.fontFamily).style("font-size",void 0===this.axisFontSize?Math.min(.95,Math.min(this.width,this.height)/140)+"rem":this.axisFontSize).style("opacity",.85),s.selectAll("path.domain").attr("stroke","transparent")}makeAxesRough(t,e){const i="xAxis"+this.graphClass,a="yAxis"+this.graphClass,h="rough-"+i,l="rough-"+a;s.select("."+i).selectAll("path.domain").each((function(i,a){const l=s.select(this).node().getAttribute("d"),o=e.path(l,{stroke:"black",fillStyle:"hachure"});o.setAttribute("class",h),t.appendChild(o)})),s.selectAll("."+h).attr("transform",`translate(0, ${this.height})`),s.select("."+a).selectAll("path.domain").each((function(i,a){const h=s.select(this).node().getAttribute("d"),o=e.path(h,{stroke:"black",fillStyle:"hachure"});o.setAttribute("class",l),t.appendChild(o)}))}setTitle(t){this.svg.append("text").attr("x",this.width/2).attr("y",0-this.margin.top/2).attr("class","title").attr("text-anchor","middle").style("font-size",void 0===this.titleFontSize?Math.min(40,Math.min(this.width,this.height)/5)+"px":this.titleFontSize).style("font-family",this.fontFamily).style("opacity",.8).text(t)}addInteraction(){s.selectAll(this.interactionG).data("file"===this.dataFormat?this.data:this.data.values).append("rect").attr("x",0).attr("y",((t,s)=>"file"===this.dataFormat?this.yScale(t[this.labels]):this.yScale(this.data[this.labels][s]))).attr("width",((t,s)=>"file"===this.dataFormat?this.xScale(+t[this.values]):this.xScale(this.data[this.values][s]))).attr("height",this.yScale.bandwidth()).attr("fill","transparent");const t=s.select(this.el).append("div").style("opacity",0).attr("class","tooltip").style("position","absolute").style("background-color","white").style("border","solid").style("border-width","1px").style("border-radius","5px").style("padding","3px").style("font-family",this.fontFamily).style("font-size",this.tooltipFontSize).style("pointer-events","none");const e=this;s.selectAll(this.interactionG).on("mouseover",(function(){t.style("opacity",1),s.select(this).select("path").style("stroke",e.highlight),s.select(this).selectAll("path:nth-child(2)").style("stroke-width",e.strokeWidth+1.2)})),s.selectAll(this.interactionG).on("mouseout",(function(){t.style("opacity",0),s.select(this).select("path").style("stroke",e.color),s.select(this).selectAll("path:nth-child(2)").style("stroke-width",e.strokeWidth)})),s.selectAll(this.interactionG).on("mousemove",(function(i){const a=s.select(this).attr("attrX"),h=s.select(this).attr("attrY"),l=s.mouse(this);t.html(`<b>${a}</b>: ${h}`).style("opacity",.95).attr("class",(function(t){})).style("transform",`translate(${l[0]+e.margin.left}px, \n              ${l[1]-(e.height+e.margin.top+e.margin.bottom)}px)`)}))}initRoughObjects(){this.roughSvg=document.getElementById(this.roughId),this.rcAxis=st(this.roughSvg,{options:{strokeWidth:this.axisStrokeWidth,roughness:this.axisRoughness}}),this.rc=st(this.roughSvg,{options:{fill:this.color,stroke:"none"===this.stroke?void 0:this.stroke,strokeWidth:this.innerStrokeWidth,roughness:this.roughness,bowing:this.bowing,fillStyle:this.fillStyle}})}drawFromObject(){this.initRoughObjects(),this.addScales(),this.addAxes(),this.makeAxesRough(this.roughSvg,this.rcAxis),this.addLabels(),this.data.values.forEach(((t,s)=>{const e=this.rc.rectangle(0,this.yScale(this.data[this.labels][s]),this.xScale(t),this.yScale.bandwidth(),{simplification:this.simplification,fillWeight:this.fillWeight}),i=this.roughSvg.appendChild(e);i.setAttribute("class",this.graphClass),i.setAttribute("attrX",this.data[this.labels][s]),i.setAttribute("attrY",+t)})),s.selectAll(this.interactionG).selectAll("path:nth-child(2)").style("stroke-width",this.strokeWidth),!0===this.interactive&&this.addInteraction()}drawFromFile(){this.initRoughObjects(),this.addScales(),this.addAxes(),this.makeAxesRough(this.roughSvg,this.rcAxis),this.addLabels(),this.data.forEach((t=>{const s=this.rc.rectangle(0,this.yScale(t[this.labels]),this.xScale(+t[this.values]),this.yScale.bandwidth(),{simplification:this.simplification,fillWeight:this.fillWeight}),e=this.roughSvg.appendChild(s);e.setAttribute("class",this.graphClass),e.setAttribute("attrX",t[this.labels]),e.setAttribute("attrY",+t[this.values])})),s.selectAll(this.interactionG).selectAll("path:nth-child(2)").style("stroke-width",this.strokeWidth),!0===this.interactive&&this.addInteraction()}}const nt=["coral","skyblue","#66c2a5","tan","#8da0cb","#e78ac3","#a6d854","#ffd92f","coral","skyblue","tan","orange"],ct=(t,e,i,a,h)=>{t.svg.append("svg").attr("x","left"===t.legendPosition?5:t.width-(i+2)).attr("y",0);const l=void 0===h?5-t.margin.left:h,o=t.rc.rectangle("left"===t.legendPosition?l:t.width+t.margin.right-2-i,-t.margin.top/3,i,a,{fill:"white",fillWeight:.1,strokeWidth:.75,roughness:2}),r=t.roughSvg.appendChild(o),n="rough"+t.el.substring(1,t.el.length);r.setAttribute("class",n),e.forEach(((e,a)=>{const h=s.select("."+n).append("g").attr("transform",`translate(\n        ${"left"===t.legendPosition?5:t.width-(i+2)},\n        0)`);h.append("rect").style("fill",t.colors[a]).attr("width",20).attr("height",8).attr("x","left"===t.legendPosition?l:t.margin.right+5).attr("y",6+11*a-t.margin.top/3),h.append("text").style("font-size",".8rem").style("font-family",t.fontFamily).attr("x","left"===t.legendPosition?l+25:t.margin.right+30).attr("y",6+11*a+8-t.margin.top/3).text(e.text)}))};class dt extends ht{constructor(t){super(t),this.margin=t.margin||{top:50,right:20,bottom:10,left:20},this.colors=et(t,"colors",nt),this.highlight=t.highlight,this.roughness=lt({roughness:t.roughness,ceiling:30}),this.strokeWidth=et(t,"strokeWidth",.75),this.innerStrokeWidth=et(t,"innerStrokeWidth",.75),this.fillWeight=et(t,"fillWeight",.85),this.labels="object"===this.dataFormat?"labels":t.labels,this.values="object"===this.dataFormat?"values":t.values,void 0!==this.labels&&void 0!==this.values?(this.legend=!1!==t.legend,this.legendPosition=et(t,"legendPosition","right"),this.initChartValues(t),this.resolveFont(),this.drawChart=this.resolveData(t.data),this.drawChart(),"undefined"!==t.title&&this.setTitle(t.title)):console.log(`Error for ${this.el}: Must include labels and values when        instantiating Donut chart. Skipping chart.`)}initChartValues(t){const s=t.width?t.width:300,e=t.height?t.height:300;this.width=s-this.margin.left-this.margin.right,this.height=e-this.margin.top-this.margin.bottom,this.roughId=this.el+"_svg",this.graphClass=this.el.substring(1,this.el.length),this.interactionG="g."+this.graphClass,this.radius=Math.min(this.width,this.height)/2,this.setSvg()}resolveData(t){return"string"!=typeof t?()=>{this.data=t,this.drawFromObject()}:t.includes(".csv")?()=>{s.csv(t).then((t=>{this.data=t,this.drawFromFile()}))}:t.includes(".tsv")?()=>{s.tsv(t).then((t=>{this.data=t,this.drawFromFile()}))}:t.includes(".json")?()=>{s.json(t).then((t=>{this.data=t,this.drawFromFile()}))}:void 0}setTitle(t){this.svg.append("text").attr("x",this.width/2).attr("y",0-this.margin.top/3).attr("class","title").attr("text-anchor","middle").style("font-size",void 0===this.titleFontSize?Math.min(40,Math.min(this.width,this.height)/4)+"px":this.titleFontSize).style("font-family",this.fontFamily).style("opacity",.8).text(t)}addInteraction(){s.selectAll(this.interactionG).append("g").attr("transform",`translate(${this.width/2}, ${this.height/2})`).data("object"===this.dataFormat?this.makePie(this.data[this.values]):this.makePie(this.data)).append("path").attr("d",this.makeArc).attr("stroke-width","0px").attr("fill","transparent");const t=s.select(this.el).append("div").style("opacity",0).attr("class","tooltip").style("position","absolute").style("background-color","white").style("border","solid").style("border-width","1px").style("border-radius","5px").style("padding","3px").style("font-family",this.fontFamily).style("font-size",this.tooltipFontSize).style("pointer-events","none");const e=this;let i;s.selectAll(this.interactionG).on("mouseover",(function(){t.style("opacity",1),i=s.select(this).selectAll("path").style("stroke"),void 0===e.highlight?s.select(this).selectAll("path").style("opacity",.5):s.select(this).selectAll("path").style("stroke",e.highlight)})),s.selectAll(this.interactionG).on("mouseout",(function(){t.style("opacity",0),s.select(this).selectAll("path").style("stroke",i),s.select(this).selectAll("path").style("opacity",1)})),s.selectAll(this.interactionG).on("mousemove",(function(i){const a=s.select(this).attr("attrX"),h=s.select(this).attr("attrY"),l=s.mouse(this);t.html(`<b>${a}</b>: ${h}`).style("opacity",.95).attr("class",(function(t){})).style("transform",`translate(${l[0]+e.margin.left}px, \n                            ${l[1]-e.height-e.margin.bottom}px)`)}))}initRoughObjects(){this.roughSvg=document.getElementById(this.roughId),this.rcAxis=st(this.roughSvg,{options:{strokeWidth:this.strokeWidth>=3?3:this.strokeWidth}}),this.rc=st(this.roughSvg,{options:{fill:this.color,strokeWidth:this.innerStrokeWidth,roughness:this.roughness,bowing:this.bowing,fillStyle:this.fillStyle,fillWeight:this.fillWeight}})}drawFromObject(){this.initRoughObjects(),this.makePie=s.pie(),this.makeArc=s.arc().innerRadius(0).outerRadius(this.radius),this.arcs=this.makePie(this.data[this.values]),this.arcs.forEach(((t,s)=>{if(0!==t.value){const e=this.rc.arc(this.width/2,this.height/2,2*this.radius,2*this.radius,t.startAngle-Math.PI/2,t.endAngle-Math.PI/2,!0,{fill:this.colors[s],stroke:this.colors[s]});e.setAttribute("class",this.graphClass);const i=this.roughSvg.appendChild(e);i.setAttribute("attrY",this.data[this.values][s]),i.setAttribute("attrX",this.data[this.labels][s])}}));const t=this.rc.circle(this.width/2,this.height/2,this.radius,{fill:"white",strokeWidth:.05,fillWeight:10,fillStyle:"solid"});this.roughSvg.appendChild(t),s.selectAll(this.interactionG).selectAll("path:nth-child(2)").style("stroke-width",this.strokeWidth);const e=this.data.labels.map(((t,s)=>({color:this.colors[s],text:t}))),i=6*e.reduce(((t,s)=>t>s.text.length?t:s.text.length),0)+35,a=11*e.length+8;!0===this.legend&&ct(this,e,i,a),!0===this.interactive&&this.addInteraction()}drawFromFile(){this.initRoughObjects(),this.makePie=s.pie().value((t=>t[this.values])).sort(null);const t=[];this.makeArc=s.arc().innerRadius(0).outerRadius(this.radius),this.arcs=this.makePie(this.data),this.arcs.forEach(((s,e)=>{if(0!==s.value){const t=this.rc.arc(this.width/2,this.height/2,2*this.radius,2*this.radius,s.startAngle-Math.PI/2,s.endAngle-Math.PI/2,!0,{fill:this.colors[e],stroke:this.colors[e]});t.setAttribute("class",this.graphClass);const i=this.roughSvg.appendChild(t);i.setAttribute("attrY",s.data[this.values]),i.setAttribute("attrX",s.data[this.labels])}t.push(s.data[this.labels])}));const e=this.rc.circle(this.width/2,this.height/2,this.radius,{fill:"white",strokeWidth:.05,fillWeight:10,fillStyle:"solid"});this.roughSvg.appendChild(e),s.selectAll(this.interactionG).selectAll("path:nth-child(2)").style("stroke-width",this.strokeWidth);const i=t.map(((t,s)=>({color:this.colors[s],text:t}))),a=6*i.reduce(((t,s)=>t>s.text.length?t:s.text.length),0)+35,h=11*i.length+8;!0===this.legend&&ct(this,i,a,h),!0===this.interactive&&this.addInteraction()}}class ut extends ht{constructor(t){super(t),this.margin=t.margin||{top:50,right:20,bottom:50,left:100},this.roughness=lt({roughness:t.roughness,defaultValue:2.2}),this.axisStrokeWidth=et(t,"axisStrokeWidth",.4),this.axisRoughness=et(t,"axisRoughness",.9),this.stroke=et(t,"stroke","black"),this.fillWeight=et(t,"fillWeight",.85),this.colors=t.colors,this.strokeWidth=et(t,"strokeWidth",8),this.axisFontSize=t.axisFontSize,this.x=t.x,this.y="object"===this.dataFormat?"y":t.y,this.xValueFormat=t.xValueFormat,this.yValueFormat=t.yValueFormat,this.legend=!1!==t.legend,this.legendPosition=et(t,"legendPosition","right"),this.circle=!1!==t.circle,this.circleRadius=et(t,"circleRadius",10),this.circleRoughness=lt({roughness:t.circleRoughness,defaultValue:2}),this.xLabel=et(t,"xLabel",""),this.yLabel=et(t,"yLabel",""),this.labelFontSize=et(t,"labelFontSize","1rem"),"file"===this.dataFormat&&(this.dataSources=[],this.yKeys=Object.keys(t).filter((t=>/y/.test(t))),this.yKeys.map(((s,e)=>{"yLabel"!==s&&this.dataSources.push(t[s])}))),this.initChartValues(t),this.resolveFont(),this.drawChart=this.resolveData(t.data),this.drawChart(),"undefined"!==t.title&&this.setTitle(t.title)}initChartValues(t){const s=t.width?t.width:300,e=t.height?t.height:400;this.width=s-this.margin.left-this.margin.right,this.height=e-this.margin.top-this.margin.bottom,this.roughId=this.el+"_svg",this.graphClass=this.el.substring(1,this.el.length),this.interactionG="g."+this.graphClass,this.setSvg()}resolveData(t){return"string"!=typeof t?()=>{this.data=t,this.drawFromObject()}:t.includes(".csv")?()=>{s.csv(t).then((t=>{this.data=t,this.drawFromFile()}))}:t.includes(".tsv")?()=>{s.tsv(t).then((t=>{this.data=t,this.drawFromFile()}))}:void 0}addScales(){let t,e;if("file"!==this.dataFormat)t=(t=>{const e=Object.keys(t).map((e=>s.extent(t[e])));return[s.min(e,(t=>t[0])),s.max(e,(t=>t[1]))]})(this.data);else{const e=this.dataSources.map((t=>s.extent(this.data,(s=>+s[t]))));t=[s.min(e,(t=>t[0])),s.max(e,(t=>t[1]))]}if(void 0===this.x){const t=Object.keys(this.data).map((t=>this.data[t].length)),i=s.max(t);e="file"===this.dataFormat?[0,this.data.length]:[0,i]}else e=s.extent(this.x);const i=t,a=i[1]-i[0];this.xScale=void 0===this.x?s.scalePoint().range([0,this.width]).domain([...Array(e[1]).keys()]):s.scalePoint().range([0,this.width]).domain(this.x),this.yScale=s.scaleLinear().range([this.height,0]).domain([0,i[1]+.05*a])}addLabels(){""!==this.xLabel&&this.svg.append("text").attr("x",this.width/2).attr("y",this.height+this.margin.bottom/1.3).attr("dx","1em").attr("class","labelText").style("text-anchor","middle").style("font-family",this.fontFamily).style("font-size",this.labelFontSize).text(this.xLabel),""!==this.yLabel&&this.svg.append("text").attr("transform","rotate(-90)").attr("y",0-this.margin.left/2).attr("x",0-this.height/2).attr("dy","1em").attr("class","labelText").style("text-anchor","middle").style("font-family",this.fontFamily).style("font-size",this.labelFontSize).text(this.yLabel)}addAxes(){const t=s.axisBottom(this.xScale).tickSize(0).tickFormat((t=>this.xValueFormat?s.format(this.xValueFormat)(t):t)),e=s.axisLeft(this.yScale).tickSize(0).tickFormat((t=>this.yValueFormat?s.format(this.yValueFormat)(t):t));this.svg.append("g").attr("transform","translate(0,"+this.height+")").call(t).attr("class","xAxis"+this.graphClass).selectAll("text").attr("transform","translate(-10, 0)rotate(-45)").style("text-anchor","end").style("font-family",this.fontFamily).style("font-size",void 0===this.axisFontSize?Math.min(.95,Math.min(this.width,this.height)/140)+"rem":this.axisFontSize),this.svg.append("g").call(e).attr("class","yAxis"+this.graphClass).selectAll("text").style("font-family",this.fontFamily).style("font-size",void 0===this.axisFontSize?Math.min(.95,Math.min(this.width,this.height)/140)+"rem":this.axisFontSize),s.selectAll("path.domain").attr("stroke","transparent"),s.selectAll("g.tick").style("opacity",1)}makeAxesRough(t,e){const i="xAxis"+this.graphClass,a="yAxis"+this.graphClass,h="rough-"+i,l="rough-"+a;s.select("."+i).selectAll("path.domain").each((function(i,a){const l=s.select(this).node().getAttribute("d"),o=e.path(l,{stroke:"black",fillStyle:"hachure"});o.setAttribute("class",h),t.appendChild(o)})),s.selectAll("."+h).attr("transform",`translate(0, ${this.height})`),s.select("."+a).selectAll("path.domain").each((function(i,a){const h=s.select(this).node().getAttribute("d"),o=e.path(h,{stroke:"black",fillStyle:"hachure"});o.setAttribute("class",l),t.appendChild(o)}))}setTitle(t){this.svg.append("text").attr("x",this.width/2).attr("y",0-this.margin.top/2).attr("text-anchor","middle").style("font-size",void 0===this.titleFontSize?Math.min(20,Math.min(this.width,this.height)/4)+"px":this.titleFontSize).style("font-family",this.fontFamily).style("opacity",.8).text(t)}addInteraction(){const t=this;this.chartScreen=this.svg.append("g").attr("pointer-events","all"),this.dataSources.map(((t,e)=>{const i=("file"===this.dataFormat?this.data:this.data[t]).map(((s,e)=>void 0===this.x?[this.xScale(e),this.yScale(s[t])]:[this.xScale(this.x[e]),this.yScale(+s[t])])).filter((t=>void 0!==t[0])),a=s.line().x((t=>t[0])).y((t=>t[1]));this.svg.append("path").datum(i).attr("fill","none").attr("stroke","blue").attr("stroke-width",1.5).attr("d",a).attr("visibility","hidden");const h=t+"class";this.svg.append("g").attr("class",h+"text").append("text").style("font-size",this.tooltipFontSize).style("opacity",0).style("font-family",this.fontFamily).attr("text-anchor","middle").attr("alignment-baseline","middle")}));this.chartScreen.append("rect").attr("width",this.width).attr("height",this.height).attr("fill","none").on("mousemove",(function(e){const i=s.mouse(this)[0],a=t.xScale.domain(),h=t.xScale.range(),l=s.range(h[0],h[1]+1,t.xScale.step()),o=s.bisect(l,i),r=a[o];t.dataSources.map(((e,i)=>{const a="file"===t.dataFormat?void 0===t.x?t.data[r]:t.data[o]:t.data[e][o],h="."+e+"class"+"text";"file"===t.dataFormat?s.select(h).selectAll("text").style("opacity",1).html(void 0===t.x?`(${o},${a[e]})`:`(${t.x[o]}, ${a[e]})`).attr("x",void 0===t.x?t.xScale(o):t.xScale(t.x[o])).attr("y",t.yScale(a[e])-6):s.select(h).selectAll("text").style("opacity",1).html(void 0===t.x?`(${o}, ${a})`:`(${t.x[o]}, ${a})`).attr("x",void 0===t.x?t.xScale(o):t.xScale(t.x[o])).attr("y",t.yScale(a))}))})).on("mouseout",(()=>{t.dataSources.map((t=>{const e="."+t+"class"+"text";s.select(e).selectAll("text").style("opacity",0)}))}))}initRoughObjects(){this.roughSvg=document.getElementById(this.roughId),this.rcAxis=st(this.roughSvg,{options:{strokeWidth:this.axisStrokeWidth,roughness:this.axisRoughness}}),this.rc=st(this.roughSvg,{options:{stroke:"none"===this.stroke?void 0:this.stroke,strokeWidth:this.strokeWidth,roughness:this.roughness,bowing:this.bowing,fillStyle:this.fillStyle}})}drawFromObject(){void 0===this.colors&&(this.colors=nt),this.dataSources=Object.keys(this.data),this.initRoughObjects(),this.addScales(),this.dataSources.map(((t,s)=>{const e=this.data[t].map(((t,s)=>void 0===this.x?[this.xScale(s),this.yScale(+t)]:[this.xScale(this.x[s]),this.yScale(t)])),i=e.filter((t=>void 0!==t[0])),a=this.rc.curve(i,{stroke:1===this.colors.length?this.colors[0]:this.colors[s],roughness:this.roughness,bowing:this.bowing});this.roughSvg.appendChild(a).setAttribute("class",this.graphClass),!0===this.circle&&e.forEach(((t,e)=>{const i=this.rc.circle(t[0],t[1],this.circleRadius,{stroke:this.colors[s],fill:this.colors[s],fillStyle:"solid",strokeWidth:1,roughness:this.circleRoughness});this.roughSvg.appendChild(i)}))}));const t=this.dataSources.map(((t,s)=>({color:this.colors[s],text:t}))),s=6*t.reduce(((t,s)=>t>s.text.length?t:s.text.length),0)+35,e=11*t.length+8;!0===this.legend&&ct(this,t,s,e,2),this.addAxes(),this.addLabels(),this.makeAxesRough(this.roughSvg,this.rcAxis),!0===this.interactive&&this.addInteraction()}drawFromFile(){void 0===this.colors&&(this.colors=nt),this.initRoughObjects(),this.addScales(),this.dataSources.map(((t,s)=>{const e=this.data.map(((s,e)=>void 0===this.x?[this.xScale(e),this.yScale(s[t])]:[this.xScale(this.x[e]),this.yScale(+s[t])])).filter((t=>void 0!==t[0])),i=this.rc.curve(e,{stroke:this.colors[s],strokeWidth:this.strokeWidth,roughness:1,bowing:10});this.roughSvg.appendChild(i),!0===this.circle&&e.forEach(((t,e)=>{const i=this.rc.circle(t[0],t[1],this.circleRadius,{stroke:this.colors[s],fill:this.colors[s],fillStyle:"solid",strokeWidth:1,roughness:this.circleRoughness});this.roughSvg.appendChild(i)}))}));const t=this.dataSources.map(((t,s)=>({color:this.colors[s],text:t}))),s=6*t.reduce(((t,s)=>t>s.text.length?t:s.text.length),0)+35,e=11*t.length+8;!0===this.legend&&ct(this,t,s,e,2),this.addAxes(),this.addLabels(),this.makeAxesRough(this.roughSvg,this.rcAxis),!0===this.interactive&&this.addInteraction()}}class gt extends ht{constructor(t){super(t),this.margin=t.margin||{top:50,right:20,bottom:10,left:20},this.colors=et(t,"colors",nt),this.highlight=t.highlight,this.roughness=lt({roughness:t.roughness,ceiling:30,defaultValue:0}),this.strokeWidth=et(t,"strokeWidth",.75),this.innerStrokeWidth=et(t,"innerStrokeWidth",1),this.fillWeight=et(t,"fillWeight",.5),this.labels="object"===this.dataFormat?"labels":t.labels,this.values="object"===this.dataFormat?"values":t.values,void 0!==this.labels&&void 0!==this.values?(this.legend=!1!==t.legend,this.legendPosition=et(t,"legendPosition","right"),this.initChartValues(t),this.resolveFont(),this.drawChart=this.resolveData(t.data),this.drawChart(),"undefined"!==t.title&&this.setTitle(t.title)):console.log(`Error for ${this.el}: Must include labels and values when        instantiating Donut chart. Skipping chart.`)}initChartValues(t){const s=t.width?t.width:350,e=t.height?t.height:450;this.width=s-this.margin.left-this.margin.right,this.height=e-this.margin.top-this.margin.bottom,this.roughId=this.el+"_svg",this.graphClass=this.el.substring(1,this.el.length),this.interactionG="g."+this.graphClass,this.radius=Math.min(this.width,this.height)/2,this.setSvg()}resolveData(t){return"string"!=typeof t?()=>{this.data=t,this.drawFromObject()}:t.includes(".csv")?()=>{s.csv(t).then((t=>{console.log(t),this.data=t,this.drawFromFile()}))}:t.includes(".tsv")?()=>{s.tsv(t).then((t=>{console.log(t),this.data=t,this.drawFromFile()}))}:t.includes(".json")?()=>{s.json(t).then((t=>{console.log(t),this.data=t,this.drawFromFile()}))}:void 0}setTitle(t){this.svg.append("text").attr("x",this.width/2).attr("y",0-this.margin.top/3).attr("class","title").attr("text-anchor","middle").style("font-size",void 0===this.titleFontSize?Math.min(40,Math.min(this.width,this.height)/4)+"px":this.titleFontSize).style("font-family",this.fontFamily).style("opacity",.8).text(t)}addInteraction(){s.selectAll(this.interactionG).append("g").attr("transform",`translate(${this.width/2}, ${this.height/2})`).data("object"===this.dataFormat?this.makePie(this.data[this.values]):this.makePie(this.data)).append("path").attr("d",this.makeArc).attr("stroke-width","0px").attr("fill","transparent");const t=s.select(this.el).append("div").style("opacity",0).attr("class","tooltip").style("position","absolute").style("background-color","white").style("border","solid").style("border-width","1px").style("border-radius","5px").style("padding","3px").style("font-family",this.fontFamily).style("font-size",this.tooltipFontSize).style("pointer-events","none");const e=this;let i;s.selectAll(this.interactionG).on("mouseover",(function(){t.style("opacity",1),i=s.select(this).selectAll("path").style("stroke"),void 0===e.highlight?s.select(this).selectAll("path").style("opacity",.5):s.select(this).selectAll("path").style("stroke",e.highlight)})),s.selectAll(this.interactionG).on("mouseout",(function(){t.style("opacity",0),s.select(this).selectAll("path").style("stroke",i),s.select(this).selectAll("path").style("opacity",1)})),s.selectAll(this.interactionG).on("mousemove",(function(i){const a=s.select(this).attr("attrX"),h=s.select(this).attr("attrY"),l=s.mouse(this);t.html(`<b>${a}</b>: ${h}`).style("opacity",.95).attr("class",(function(t){})).style("transform",`translate(${l[0]+e.margin.left}px, \n                            ${l[1]-e.height-e.margin.bottom}px)`)}))}initRoughObjects(){this.roughSvg=document.getElementById(this.roughId),this.rcAxis=st(this.roughSvg,{options:{strokeWidth:this.strokeWidth>=3?3:this.strokeWidth}}),this.rc=st(this.roughSvg,{options:{fill:this.color,strokeWidth:this.innerStrokeWidth,roughness:this.roughness,bowing:this.bowing,fillStyle:this.fillStyle}})}drawFromObject(){this.initRoughObjects(),this.makePie=s.pie(),this.makeArc=s.arc().innerRadius(0).outerRadius(this.radius),this.arcs=this.makePie(this.data[this.values]),this.arcs.forEach(((t,s)=>{if(0!==t.value){const e=this.rc.arc(this.width/2,this.height/2,2*this.radius,2*this.radius,t.startAngle-Math.PI/2,t.endAngle-Math.PI/2,!0,{fill:this.colors[s],stroke:this.colors[s]});e.setAttribute("class",this.graphClass);const i=this.roughSvg.appendChild(e);i.setAttribute("attrY",this.data[this.values][s]),i.setAttribute("attrX",this.data[this.labels][s])}})),s.selectAll(this.interactionG).selectAll("path:nth-child(2)").style("stroke-width",this.strokeWidth);const t=this.data.labels.map(((t,s)=>({color:this.colors[s],text:t}))),e=6*t.reduce(((t,s)=>t>s.text.length?t:s.text.length),0)+35,i=11*t.length+8;!0===this.legend&&ct(this,t,e,i),!0===this.interactive&&this.addInteraction()}drawFromFile(){this.initRoughObjects(),this.makePie=s.pie().value((t=>t[this.values])).sort(null);const t=[];this.makeArc=s.arc().innerRadius(0).outerRadius(this.radius),this.arcs=this.makePie(this.data),this.arcs.forEach(((s,e)=>{if(0!==s.value){const t=this.rc.arc(this.width/2,this.height/2,2*this.radius,2*this.radius,s.startAngle-Math.PI/2,s.endAngle-Math.PI/2,!0,{fill:this.colors[e],stroke:this.colors[e]});t.setAttribute("class",this.graphClass);const i=this.roughSvg.appendChild(t);i.setAttribute("attrY",s.data[this.values]),i.setAttribute("attrX",s.data[this.labels])}t.push(s.data[this.labels])})),s.selectAll(this.interactionG).selectAll("path:nth-child(2)").style("stroke-width",this.strokeWidth);const e=t.map(((t,s)=>({color:this.colors[s],text:t}))),i=6*e.reduce(((t,s)=>t>s.text.length?t:s.text.length),0)+35,a=11*e.length+8;!0===this.legend&&ct(this,e,i,a),!0===this.interactive&&this.addInteraction()}}const pt=["pink","skyblue","coral","gold","teal","grey","darkgreen","pink","brown","slateblue","grey1","orange"];class ft extends ht{constructor(t){super(t),this.margin=t.margin||{top:50,right:20,bottom:50,left:100},this.colorVar=t.colorVar,this.roughness=lt({roughness:t.roughness}),this.highlight=t.highlight,this.highlightLabel=et(t,"highlightLabel","xy"),this.radius=et(t,"radius",8),this.axisStrokeWidth=et(t,"axisStrokeWidth",.4),this.axisRoughness=et(t,"axisRoughness",.9),this.curbZero=!0===t.curbZero,this.innerStrokeWidth=et(t,"innerStrokeWidth",1),this.stroke=et(t,"stroke","black"),this.fillWeight=et(t,"fillWeight",.85),this.colors=t.colors,this.strokeWidth=et(t,"strokeWidth",1),this.axisFontSize=t.axisFontSize,this.x="object"===this.dataFormat?"x":t.x,this.y="object"===this.dataFormat?"y":t.y,this.xValueFormat=t.xValueFormat,this.yValueFormat=t.yValueFormat,this.xLabel=et(t,"xLabel",""),this.yLabel=et(t,"yLabel",""),this.labelFontSize=et(t,"labelFontSize","1rem"),this.initChartValues(t),this.resolveFont(),this.drawChart=this.resolveData(t.data),this.drawChart(),"undefined"!==t.title&&this.setTitle(t.title)}initChartValues(t){const s=t.width?t.width:300,e=t.height?t.height:400;this.width=s-this.margin.left-this.margin.right,this.height=e-this.margin.top-this.margin.bottom,this.roughId=this.el+"_svg",this.graphClass=this.el.substring(1,this.el.length),this.interactionG="g."+this.graphClass,this.setSvg()}resolveData(t){return"string"!=typeof t?()=>{this.data=t,this.drawFromObject()}:t.includes(".csv")?()=>{s.csv(t).then((t=>{console.log(t),this.data=t,this.drawFromFile()}))}:t.includes(".tsv")?()=>{s.tsv(t).then((t=>{this.data=t,this.drawFromFile()}))}:void 0}addScales(){const t="file"===this.dataFormat?s.extent(this.data,(t=>+t[this.x])):s.extent(this.data[this.x]),e=t[1]-t[0],i="file"===this.dataFormat?s.extent(this.data,(t=>+t[this.y])):s.extent(this.data[this.y]),a=i[1]-i[0],h="file"===this.dataFormat?s.extent(this.data,(t=>t[this.colorVar])):[1,1];if("file"===this.dataFormat){const t=s.extent(this.data,(t=>+t[this.radius])),e=Math.min(this.width,this.height)/2/2;this.radiusScale=s.scaleLinear().range([8,e]).domain(t)}!0===this.curbZero&&(i[0]>0&&(i[0]=0),t[0]>0&&(t[0]=0)),this.xScale=s.scaleLinear().range([0,this.width]).domain([t[0]-.05*e,t[1]+.05*e]),this.yScale=s.scaleLinear().range([this.height,0]).domain([i[0]-.05*a,i[1]+.05*a]),this.colorScale=s.scaleOrdinal().range(this.colors).domain(h)}addLabels(){""!==this.xLabel&&this.svg.append("text").attr("x",this.width/2).attr("y",this.height+this.margin.bottom/1.3).attr("dx","1em").attr("class","labelText").style("text-anchor","middle").style("font-family",this.fontFamily).style("font-size",this.labelFontSize).text(this.xLabel),""!==this.yLabel&&this.svg.append("text").attr("transform","rotate(-90)").attr("y",0-this.margin.left/2).attr("x",0-this.height/2).attr("dy","1em").attr("class","labelText").style("text-anchor","middle").style("font-family",this.fontFamily).style("font-size",this.labelFontSize).text(this.yLabel)}addAxes(){const t=s.axisBottom(this.xScale).tickSize(0).tickFormat((t=>this.xValueFormat?s.format(this.xValueFormat)(t):t)),e=s.axisLeft(this.yScale).tickSize(0).tickFormat((t=>this.yValueFormat?s.format(this.yValueFormat)(t):t));this.svg.append("g").attr("transform","translate(0,"+this.height+")").call(t).attr("class","xAxis"+this.graphClass).selectAll("text").attr("transform","translate(-10, 0)rotate(-45)").style("text-anchor","end").style("font-family",this.fontFamily).style("font-size",void 0===this.axisFontSize?Math.min(.95,Math.min(this.width,this.height)/140)+"rem":this.axisFontSize),this.svg.append("g").call(e).attr("class","yAxis"+this.graphClass).selectAll("text").style("font-family",this.fontFamily).style("font-size",void 0===this.axisFontSize?Math.min(.95,Math.min(this.width,this.height)/140)+"rem":this.axisFontSize),s.selectAll("path.domain").attr("stroke","transparent"),s.selectAll("g.tick").style("opacity",1)}makeAxesRough(t,e){const i="xAxis"+this.graphClass,a="yAxis"+this.graphClass,h="rough-"+i,l="rough-"+a;s.select("."+i).selectAll("path.domain").each((function(i,a){const l=s.select(this).node().getAttribute("d"),o=e.path(l,{stroke:"black",fillStyle:"hachure"});o.setAttribute("class",h),t.appendChild(o)})),s.selectAll("."+h).attr("transform",`translate(0, ${this.height})`),s.select("."+a).selectAll("path.domain").each((function(i,a){const h=s.select(this).node().getAttribute("d"),o=e.path(h,{stroke:"black",fillStyle:"hachure"});o.setAttribute("class",l),t.appendChild(o)}))}setTitle(t){this.svg.append("text").attr("x",this.width/2).attr("y",0-this.margin.top/2).attr("text-anchor","middle").style("font-size",void 0===this.titleFontSize?Math.min(20,Math.min(this.width,this.height)/4)+"px":this.titleFontSize).style("font-family",this.fontFamily).style("opacity",.8).text(t)}addInteraction(){const t=s.selectAll(this.interactionG).data("file"===this.dataFormat?this.data:this.data.x).append("circle").attr("cx",((t,s)=>"file"===this.dataFormat?this.xScale(+t[this.x]):this.xScale(+this.data[this.x][s]))).attr("cy",((t,s)=>"file"===this.dataFormat?this.yScale(+t[this.y]):this.yScale(+this.data[this.y][s])));"file"===this.dataFormat?t.attr("r",(t=>"number"==typeof this.radius?.7*this.radius:.6*this.radiusScale(+t[this.radius]))).attr("fill","transparent"):t.attr("r",((t,s)=>"number"==typeof this.radius?.7*this.radius:.6*this.radius[s])).attr("fill","transparent");var e=s.select(this.el).append("div").style("opacity",0).attr("class","tooltip").style("position","absolute").style("background-color","white").style("border","solid").style("border-width","1px").style("border-radius","5px").style("padding","3px").style("font-family",this.fontFamily).style("font-size",this.tooltipFontSize).style("pointer-events","none");const i=this;let a;s.selectAll(this.interactionG).on("mouseover",(function(){e.style("opacity",1),a=s.select(this).selectAll("path").style("stroke"),void 0===i.highlight?s.select(this).selectAll("path:nth-child(1)").style("opacity",.4):s.select(this).selectAll("path:nth-child(1)").style("stroke",i.highlight),s.select(this).selectAll("path:nth-child(2)").style("stroke-width",i.strokeWidth+1.2)})),s.selectAll(this.interactionG).on("mouseout",(function(){e.style("opacity",0),s.select(this).selectAll("path").style("opacity",1),s.select(this).selectAll("path:nth-child(1)").style("stroke",a),s.select(this).selectAll("path:nth-child(2)").style("stroke",i.stroke),s.select(this).selectAll("path:nth-child(2)").style("stroke-width",i.strokeWidth)})),s.selectAll(this.interactionG).on("mousemove",(function(t){const a=s.select(this).attr("attrX"),h=s.select(this).attr("attrY"),l=s.select(this).attr("attrHighlightLabel"),o=s.mouse(this);e.html("xy"===i.highlightLabel?`<b>x</b>: ${a} <br><b>y</b>: ${h}`:`<b>${l}</b>`).attr("class",(function(t){})).style("transform",`translate(${o[0]+i.margin.left}px, \n          ${o[1]-(i.height+i.margin.top+i.margin.bottom)}px)`)}))}initRoughObjects(){this.roughSvg=document.getElementById(this.roughId),this.rcAxis=st(this.roughSvg,{options:{strokeWidth:this.axisStrokeWidth,roughness:this.axisRoughness}}),this.rc=st(this.roughSvg,{options:{stroke:"none"===this.stroke?void 0:this.stroke,strokeWidth:this.innerStrokeWidth,roughness:this.roughness,bowing:this.bowing,fillStyle:this.fillStyle}})}drawFromObject(){void 0===this.colors&&(this.colors=pt[0]),this.initRoughObjects(),this.addScales(),this.addAxes(),this.makeAxesRough(this.roughSvg,this.rcAxis),this.addLabels(),this.data.x.forEach(((t,s)=>{const e=this.rc.circle(this.xScale(+t),this.yScale(+this.data[this.y][s]),"number"==typeof this.radius?this.radius:this.radius[s],{fill:"string"==typeof this.colors?this.colors:1===this.colors.length?this.colors[0]:this.colors[s],simplification:this.simplification,fillWeight:this.fillWeight}),i=this.roughSvg.appendChild(e);i.setAttribute("class",this.graphClass),i.setAttribute("attrX",t),i.setAttribute("attrY",this.data[this.y][s]),i.setAttribute("attrHighlightLabel",this.data[this.highlightLabel])})),s.selectAll(this.interactionG).selectAll("path:nth-child(2)").style("stroke-width",this.strokeWidth),!0===this.interactive&&this.addInteraction()}drawFromFile(){void 0===this.colors&&(this.colors=pt),this.initRoughObjects(),this.addScales(),this.addAxes(),this.makeAxesRough(this.roughSvg,this.rcAxis),this.addLabels(),this.data.forEach(((t,s)=>{const e=this.rc.circle(this.xScale(+t[this.x]),this.yScale(+t[this.y]),"number"==typeof this.radius?this.radius:this.radiusScale(+t[this.radius]),{fill:void 0===this.colorVar?this.colors[0]:this.colorScale(t[this.colorVar]),simplification:this.simplification,fillWeight:this.fillWeight}),i=this.roughSvg.appendChild(e);i.setAttribute("class",this.graphClass),i.setAttribute("attrX",t[this.x]),i.setAttribute("attrY",t[this.y]),i.setAttribute("attrHighlightLabel",t[this.highlightLabel])})),s.selectAll(this.interactionG).selectAll("path:nth-child(2)").style("stroke-width",this.strokeWidth),!0===this.interactive&&this.addInteraction()}}class mt extends ht{constructor(t){super(t),this.data=t.data,this.margin=t.margin||{top:50,right:20,bottom:70,left:100},this.colors=et(t,"colors",nt),this.highlight=et(t,"highlight","coral"),this.roughness=lt({roughness:t.roughness}),this.stroke=et(t,"stroke","black"),this.strokeWidth=et(t,"strokeWidth",1),this.axisStrokeWidth=et(t,"axisStrokeWidth",.5),this.axisRoughness=et(t,"axisRoughness",.5),this.innerStrokeWidth=et(t,"innerStrokeWidth",1),this.fillWeight=et(t,"fillWeight",.5),this.axisFontSize=t.axisFontSize,this.labels=t.labels,this.values=t.values,this.stackColorMapping={},this.padding=et(t,"padding",.1),this.xLabel=et(t,"xLabel",""),this.yLabel=et(t,"yLabel",""),this.labelFontSize=et(t,"labelFontSize","1rem"),this.initChartValues(t),this.resolveFont(),this.drawChart=this.resolveData(t.data),this.drawChart(),"undefined"!==t.title&&this.setTitle(t.title)}initChartValues(t){const s=t.width?t.width:350,e=t.height?t.height:450;this.width=s-this.margin.left-this.margin.right,this.height=e-this.margin.top-this.margin.bottom,this.roughId=this.el+"_svg",this.graphClass=this.el.substring(1,this.el.length),this.interactionG="g."+this.graphClass,this.setSvg()}getTotal(t){for(let s=0;s<t.length;s++){let e=0;for(let i=0;i<t.columns.length;++i)t.columns[i]!==this.labels&&(e+=t[s][t.columns[i]]=+t[s][t.columns[i]]);t[s].total=e}return t}updateColorMapping(t){this.stackColorMapping[t]||(this.stackColorMapping[t]=nt[Object.keys(this.stackColorMapping).length])}resolveData(t){return"string"!=typeof t?()=>{this.data=t;for(let s=0;s<t.length;++s){let e=0;Object.keys(t[s]).forEach((i=>{i!==this.labels&&(this.updateColorMapping(i),e+=t[s][i],t[s].total=e)}))}this.drawFromObject()}:t.includes(".csv")?()=>{s.csv(t).then((t=>{this.getTotal(t),this.data=t,this.drawFromFile()}))}:t.includes(".tsv")?()=>{s.tsv(t).then((t=>{this.getTotal(t),this.data=t,this.drawFromFile()}))}:void 0}addScales(){this.xScale=s.scaleBand().rangeRound([0,this.width]).padding(this.padding).domain(this.data.map((t=>t[this.labels]))),this.data.sort((function(t,s){return s.total-t.total})),this.yScale=s.scaleLinear().rangeRound([this.height,0]).domain([0,s.max(this.data,(t=>t.total))]).nice();const t="object"===this.dataFormat?this.data.map((t=>t[this.labels])):this.data.columns;this.zScale=s.scaleOrdinal().range(["#98abc5","#8a89a6","#7b6888","#6b486b","#a05d56","#d0743c","#ff8c00"]).domain(t)}addLabels(){""!==this.xLabel&&this.svg.append("text").attr("x",this.width/2).attr("y",this.height+this.margin.bottom/2).attr("dx","1em").attr("class","labelText").style("text-anchor","middle").style("font-family",this.fontFamily).style("font-size",this.labelFontSize).text(this.xLabel),""!==this.yLabel&&this.svg.append("text").attr("transform","rotate(-90)").attr("y",0-this.margin.left/1.4).attr("x",0-this.height/2).attr("dy","1em").attr("class","labelText").style("text-anchor","middle").style("font-family",this.fontFamily).style("font-size",this.labelFontSize).text(this.yLabel)}addAxes(){const t=s.axisBottom(this.xScale).tickSize(0);this.svg.append("g").attr("transform","translate(0,"+this.height+")").call(t).attr("class","xAxis"+this.graphClass).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end").style("font-family",this.fontFamily).style("font-size",void 0===this.axisFontSize?Math.min(.8,Math.min(this.width,this.height)/140)+"rem":this.axisFontSize).style("opacity",.9);const e=s.axisLeft(this.yScale).tickSize(0);this.svg.append("g").call(e).attr("class","yAxis"+this.graphClass).selectAll("text").style("font-family",this.fontFamily).style("font-size",void 0===this.axisFontSize?Math.min(.95,Math.min(this.width,this.height)/140)+"rem":this.axisFontSize).style("opacity",.9),s.selectAll("path.domain").attr("stroke","transparent")}makeAxesRough(t,e){const i="xAxis"+this.graphClass,a="yAxis"+this.graphClass,h="rough-"+i,l="rough-"+a;s.select("."+i).selectAll("path.domain").each((function(i,a){const l=s.select(this).node().getAttribute("d"),o=e.path(l,{fillStyle:"hachure"});o.setAttribute("class",h),t.appendChild(o)})),s.selectAll("."+h).attr("transform",`translate(0, ${this.height})`),s.select("."+a).selectAll("path.domain").each((function(i,a){const h=s.select(this).node().getAttribute("d"),o=e.path(h,{fillStyle:"hachure"});o.setAttribute("class",l),t.appendChild(o)}))}setTitle(t){this.svg.append("text").attr("x",this.width/2).attr("y",0-this.margin.top/2).attr("class","title").attr("text-anchor","middle").style("font-size",void 0===this.titleFontSize?Math.min(40,Math.min(this.width,this.height)/5)+"px":this.titleFontSize).style("font-family",this.fontFamily).style("opacity",.8).text(t)}addInteraction(){s.selectAll(this.interactionG).each((function(t,e){const i=this.attributes;s.select(this).append("rect").attr("x",i.x.value).attr("y",i.y.value).attr("width",i.width.value).attr("height",i.height.value).attr("fill","transparent")}));const t=s.select(this.el).append("div").style("opacity",0).attr("class","tooltip").style("position","absolute").style("background-color","white").style("border","solid").style("border-width","1px").style("border-radius","5px").style("padding","3px").style("font-family",this.fontFamily).style("font-size",this.tooltipFontSize).style("pointer-events","none"),e=this;let i;s.selectAll(this.interactionG).on("mouseover",(function(){t.style("opacity",1),i=s.select(this).selectAll("path").style("stroke"),s.select(this).select("path").style("stroke",e.highlight),s.select(this).selectAll("path:nth-child(2)").style("stroke-width",e.strokeWidth+1.2)})),s.selectAll(this.interactionG).on("mouseout",(function(){t.style("opacity",0),s.select(this).select("path").style("stroke",i),s.select(this).selectAll("path:nth-child(2)").style("stroke-width",e.strokeWidth)})),s.selectAll(this.interactionG).on("mousemove",(function(i){const a=s.select(this).attr("attrX"),h=s.select(this).attr("attrY"),l=s.select(this).attr("keyY"),o=s.mouse(this);t.html(`<h4>${a}</h4> <b>${l}</b>: ${h}`).style("opacity",.95).attr("class",(function(t){})).style("transform",`translate(${o[0]+e.margin.left}px, \n          ${o[1]-(e.height+e.margin.top+e.margin.bottom)}px)`)}))}initRoughObjects(){this.roughSvg=document.getElementById(this.roughId),this.rcAxis=st(this.roughSvg,{options:{strokeWidth:this.axisStrokeWidth,roughness:this.axisRoughness}}),this.rc=st(this.roughSvg,{options:{stroke:"none"===this.stroke?void 0:this.stroke,strokeWidth:this.innerStrokeWidth,roughness:this.roughness,bowing:this.bowing,fillStyle:this.fillStyle}})}stacking(){this.data.forEach((t=>{const s=Object.keys(t);let e=0;s.forEach(((s,i)=>{if(i>0&&"total"!==s){e+=parseInt(t[s],10);const a=this.xScale(t[this.labels]),h=this.yScale(e),l=this.xScale.bandwidth(),o=this.height-this.yScale(+t[s]),r=this.rc.rectangle(a,h,l,o,{fill:this.stackColorMapping[s]||this.colors[i],stroke:this.stackColorMapping[s]||this.colors[i],simplification:this.simplification,fillWeight:this.fillWeight}),n=this.roughSvg.appendChild(r);n.setAttribute("class",this.graphClass),n.setAttribute("attrX",t[this.labels]),n.setAttribute("keyY",s),n.setAttribute("attrY",+t[s]),n.setAttribute("x",a),n.setAttribute("y",h),n.setAttribute("width",l),n.setAttribute("height",o)}}))}))}drawFromObject(){this.initRoughObjects(),this.addScales(),this.addAxes(),this.makeAxesRough(this.roughSvg,this.rcAxis),this.addLabels(),this.stacking(),s.selectAll(this.interactionG).selectAll("path:nth-child(2)").style("stroke-width",this.strokeWidth),!0===this.interactive&&this.addInteraction()}drawFromFile(){this.initRoughObjects(),this.addScales(),this.addAxes(),this.makeAxesRough(this.roughSvg,this.rcAxis),this.addLabels(),this.stacking(),s.selectAll(this.interactionG).selectAll("path:nth-child(2)").style("stroke-width",this.strokeWidth),!0===this.interactive&&this.addInteraction()}}const yt=["coral","skyblue","#66c2a5","tan","#8da0cb","#e78ac3","#a6d854","#ffd92f","tan","orange"],bt={axisFontSize:{type:String,default:"1rem"},axisRoughness:{type:Number,default:.5},axisStrokeWidth:{type:Number,default:.5},xLabel:String,yLabel:String},xt={legend:{type:Boolean,default:!0},legendPosition:{type:String,default:"right"}},kt={chartData:{type:[Object,String],required:!0},title:String,titleFontSize:{type:String,default:"1rem"},tooltipFontSize:{type:String,default:"0.95rem"},font:{type:[String,Number],default:"gaegu"},fillStyle:{type:String,default:"hachure"},fillWeight:Number,roughness:{type:Number,default:1},bowing:{type:Number,default:0},simplification:{type:Number,default:.2},interactive:{type:Boolean,default:!0},width:Number,height:Number,margin:{type:Object},strokeWidth:{type:Number,default:1}},St=Object.assign(Object.assign({},bt),{labels:String,values:String,highlight:{type:String,default:"coral"},innerStrokeWidth:{type:Number,default:1},labelFontSize:{type:String,default:"1rem"},padding:{type:Number,default:.1},stroke:{type:String,default:"black"}}),vt=Object.assign(Object.assign({},xt),{labels:String,values:String,colors:{type:Array,default:yt},highlight:{type:String,default:"coral"},innerStrokeWidth:{type:Number,default:.75},padding:{type:Number,default:.1}}),At=Object.assign(Object.assign({},bt),{colors:{type:[Array,String],default:yt},labelFontSize:{type:String,default:"1rem"},stroke:{type:String,default:"black"}}),Ft=Object.assign(Object.assign(Object.assign({},kt),St),{color:{type:String,default:"skyblue"}}),wt=Object.assign(Object.assign(Object.assign({},kt),St),{colors:Array,chartData:{type:Array,required:!0},labels:{type:String,required:!0}}),Mt=Object.assign(Object.assign({},kt),vt),Ct=Object.assign(Object.assign(Object.assign(Object.assign({},kt),At),xt),{chartData:{type:String,required:!0},y:String,circle:{type:Boolean,default:!0},circleRadius:{type:Number,default:10},circleRoughness:{type:Number,default:2}}),Wt=Object.assign(Object.assign(Object.assign({},kt),At),{x:String,y:String,colorVar:String,curbZero:{type:Boolean,default:!1},highlight:{type:String,default:"coral"},highlightLabel:String,innerStrokeWidth:{type:Number,default:1},radius:{type:[Number,Array]}});const zt=(s,e)=>{const i=t.ref(null),a="chartdiv"+Date.now();return t.onMounted((()=>{const h=i.value;h.id=a,t.watchEffect((()=>{const{chartData:t}=e,i=
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function(t,s){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&s.indexOf(i)<0&&(e[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(t);a<i.length;a++)s.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(t,i[a])&&(e[i[a]]=t[i[a]])}return e}(e,["chartData"]);h.innerHTML="",new s(Object.assign({element:"#"+h.id},Object.assign({data:t},i)))}))})),i};var Ot=t.defineComponent({props:Object.assign({},Ft),setup:t=>({chartdiv:zt(ot,t)})});const Lt={ref:"chartdiv"};Ot.render=function(s,e,i,a,h,l){return t.openBlock(),t.createBlock("div",Lt,null,512)},Ot.__file="src/components/BarChart.vue";var jt=t.defineComponent({props:Object.assign({},Mt),setup:t=>({chartdiv:zt(dt,t)})});const Pt={ref:"chartdiv"};jt.render=function(s,e,i,a,h,l){return t.openBlock(),t.createBlock("div",Pt,null,512)},jt.__file="src/components/DonutChart.vue";var Rt=t.defineComponent({props:Object.assign({},Ft),setup:t=>({chartdiv:zt(rt,t)})});const It={ref:"chartdiv"};Rt.render=function(s,e,i,a,h,l){return t.openBlock(),t.createBlock("div",It,null,512)},Rt.__file="src/components/HorizontalBarChart.vue";var $t=t.defineComponent({props:Object.assign({},Ct),setup(s,e){const i=t.computed((()=>{const t=e.attrs,i={};return Object.keys(t).forEach((s=>{const e=t[s];/^y\d+$/.test(s)&&"string"==typeof e&&(i[s]=e)})),Object.assign(Object.assign({},s),i)}));return{chartdiv:zt(ut,i.value)}}});const Vt={ref:"chartdiv"};$t.render=function(s,e,i,a,h,l){return t.openBlock(),t.createBlock("div",Vt,null,512)},$t.__file="src/components/LineChart.vue";var Gt=t.defineComponent({props:Object.assign({},Mt),setup:t=>({chartdiv:zt(gt,t)})});const Et={ref:"chartdiv"};Gt.render=function(s,e,i,a,h,l){return t.openBlock(),t.createBlock("div",Et,null,512)},Gt.__file="src/components/PieChart.vue";var Tt=t.defineComponent({props:Object.assign({},Wt),setup:t=>({chartdiv:zt(ft,t)})});const _t={ref:"chartdiv"};Tt.render=function(s,e,i,a,h,l){return t.openBlock(),t.createBlock("div",_t,null,512)},Tt.__file="src/components/ScatterChart.vue";var Bt=t.defineComponent({props:Object.assign({},wt),setup:t=>({chartdiv:zt(mt,t)})});const Dt={ref:"chartdiv"};Bt.render=function(s,e,i,a,h,l){return t.openBlock(),t.createBlock("div",Dt,null,512)},Bt.__file="src/components/StackedBarChart.vue",exports.BarChart=Ot,exports.DonutChart=jt,exports.HorizontalBarChart=Rt,exports.LineChart=$t,exports.PieChart=Gt,exports.ScatterChart=Tt,exports.StackedBarChart=Bt;
